<div metal:use-macro="layout.base" i18n:domain="onegov.org">
    <tal:b metal:fill-slot="title">
        ${title}
    </tal:b>
    <tal:b metal:fill-slot="content">
        <div class="row">
            <div class="columns medium-9">
                <table class="usermanagement">
                    <tal:b repeat="role ('admin', 'editor', 'member')">
                        <tbody tal:condition="users.get(role)" tal:define="enable_yubikey request.app.enable_yubikey">
                            <tr class="subheader">
                                <td colspan="${enable_yubikey and '3' or '4'}">
                                    <tal:b metal:use-macro="layout.macros['role-plural']" />
                                    (${len(users.get(role))})
                                </td>
                                <td colspan="2" tal:condition="enable_yubikey" i18n:translate>
                                    Yubikey
                                </td>
                            </tr>
                            <tr tal:repeat="user users[role]" class="${user.active and 'user-active' or 'user-inactive'}">
                                <td><a href="${request.link(user)}">${user.username}</a></td>
                                <td>${user.realname}</td>
                                <td i18n:translate tal:condition="user.active">Active</td>
                                <td i18n:translate tal:condition="not:user.active">Inactive</td>

                                <tal:b define="serial user.yubikey_serial" condition="enable_yubikey">
                                    <td tal:condition="serial"><span class="yubikey">${serial}</span></td>
                                    <td tal:condition="not:serial" i18n:translate></td>
                                </tal:b>

                                <td class="text-links">
                                    <a href="${request.link(user)}" i18n:translate>View</a>&nbsp;<a href="${request.link(user, 'edit')}" i18n:translate>Edit</a>
                                </td>
                            </tr>
                        </tbody>
                    </tal:b>
                </table>
            </div>
            <div class="columns medium-3 filter-panel">
                <div tal:condition="filters['active']|nothing" class="filter-active">
                    <h2 class="filter-title" i18n:translate>State</h2>
                    <div metal:use-macro="layout.macros['tags']" tal:define="tags filters['active']" />
                </div>
                <div tal:condition="filters['role']|nothing" class="filter-role">
                    <h2 class="filter-title" i18n:translate>Role</h2>
                    <div metal:use-macro="layout.macros['tags']" tal:define="tags filters['role']" />
                </div>
                <div tal:condition="filters['tag']|nothing" class="filter-tags">
                    <h2 class="filter-title" i18n:translate>Tags</h2>
                    <div metal:use-macro="layout.macros['tags']" tal:define="tags filters['tag']" />
                </div>
            </div>
        </div>
    </tal:b>
</div>