<div metal:use-macro="layout.base" i18n:domain="onegov.org">
    <tal:block metal:fill-slot="title">
        ${title}
    </tal:block>
    <tal:block metal:fill-slot="content">

        <table class="usermanagement">
            <tal:block repeat="role ('admin', 'editor', 'member')">
                <tbody tal:condition="users.get(role)" tal:define="enable_yubikey request.app.settings.org.enable_yubikey">
                    <tr class="subheader">
                        <td colspan="${enable_yubikey and '3' or '4'}">
                            <tal:block metal:use-macro="layout.macros['role-plural']" />
                            (${len(users.get(role))})
                        </td>
                        <td colspan="2" tal:condition="enable_yubikey" i18n:translate>
                            Yubikey
                        </td>
                    </tr>
                    <tr tal:repeat="user users[role]" class="${user.active and 'user-active' or 'user-inactive'}">
                        <td><a href="mailto:${user.username}">${user.username}</a></td>
                        <td>${user.realname}</td>
                        <td i18n:translate tal:condition="user.active">Active</td>
                        <td i18n:translate tal:condition="not:user.active">Inactive</td>

                        <tal:block define="serial user.yubikey_serial" condition="enable_yubikey">
                            <td tal:condition="serial"><span class="yubikey">${serial}</span></td>
                            <td tal:condition="not:serial" i18n:translate></td>
                        </tal:block>
                        
                        <td><a href="${request.link(user)}" i18n:translate>Edit</a></td>
                    </tr>
                </tbody>
            </tal:block>
        </table>

    </tal:block>
</div>