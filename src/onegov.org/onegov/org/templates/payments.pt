<div metal:use-macro="layout.base" i18n:domain="onegov.org">
    <tal:block metal:fill-slot="title">
        ${title}
    </tal:block>
    <tal:block metal:fill-slot="content">
        <table class="payments-table">
            <thead>
                <tr>
                    <th i18n:translate>
                        Object
                    </th>
                    <th i18n:translate>
                        Amount
                    </th>
                    <th i18n:translate>
                        Payment Provider
                    </th>
                    <th i18n:translate>
                        State
                    </th>
                    <th i18n:translate>
                        Created
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr tal:repeat="payment payments">
                    <td>
                        <tal:b repeat="link payment_links[payment.id]">
                            <tal:b switch="link.__tablename__">
                                <tal:b case="'submissions'">
                                    <tal:b define="ticket get_ticket(link)">
                                        <div>
                                            <a href="${request.link(ticket)}">
                                                <strong>${ticket.number}</strong>
                                            </a>
                                            <div>
                                                ${link.title}
                                            </div>
                                        </div>
                                    </tal:b>
                                </tal:b>
                                <tal:b case="'reservations'" condition="repeat.link.start">
                                    <tal:b define="ticket get_ticket(link)">
                                        <div>
                                            <a href="${request.link(ticket)}">
                                                <strong>${ticket.number}</strong>
                                            </a>
                                            <div>
                                                ${link.title}
                                            </div>
                                        </div>
                                    </tal:b>
                                </tal:b>
                            </tal:b>
                        </tal:b>
                    </td>
                    <td>${'{0:2f}'.format(payment.amount)} ${payment.currency}</td>
                    <td>
                        <span tal:condition="payment.provider_id">
                            ${providers[payment.provider_id].title}
                        </span>
                        <span tal:condition="not:payment.provider" i18n:translate>
                            Manual
                        </span>
                    </td>
                    <td>
                        <metal:b use-macro="layout.macros['payment_status']" />
                    </td>
                    <td>
                        ${layout.format_date(payment.created, 'datetime')}
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="pagination-centered">
            <div metal:use-macro="layout.macros['pagination']" tal:define="
            collection layout.model; current_page layout.model;" />
        </div>
    </tal:block>
</div>