<div metal:use-macro="layout.base" i18n:domain="onegov.election_day">
    <tal:block metal:fill-slot="content">
        <h2>${vote.title}</h2>

        <tal:block condition="vote.answer">
            <h3>
                <span i18n:translate="">Result:</span>
                <div metal:use-macro="layout.macros['answer']" tal:define="answer vote.answer" />
            </h3>

            <div class="row">
                <div class="columns small-12 medium-2">
                    <dl>
                        <dt i18n:translate="">Yays</dt>
                        <dd class="accepted" >${vote.yays} / ${'{0:.2f}'.format(vote.yays_percentage)} %</dd>
                    </dl>
                </div>
                <div class="columns small-12 medium-2 end">
                    <dl>
                        <dt i18n:translate="">Nays</dt>
                        <dd class="rejected" >${vote.nays} / ${'{0:.2f}'.format(vote.nays_percentage)} %</dd>
                    </dl>
                </div>
            </div>
        </tal:block>

        <ul class="small-block-grid-1 medium-block-grid-4 factoids">
            <li>
                <strong i18n:translate="">Counted municipalities</strong>
                <span metal:use-macro="layout.macros['progress']" tal:define="progress vote.progress" />
            </li>
            <li>
                <strong i18n:translate="">Elegible Voters</strong>
                <span>${vote.elegible_voters}</span>
            </li>
            <li>
                <strong i18n:translate="">Cast Ballots</strong>
                <span>${vote.cast_ballots}</span>
            </li>
            <li>
                <strong i18n:translate="">Turnout</strong>
                <span>${'{0:.2f}'.format(vote.turnout)} %</span>
            </li>
            <li>
                <strong i18n:translate="">Empty Ballots</strong>
                <span>${vote.empty}</span>
            </li>
            <li>
                <strong i18n:translate="">Invalid Ballots</strong>
                <span>${vote.invalid}</span>
            </li>
            <li>
                <strong i18n:translate="">Valid Ballots</strong>
                <span>${vote.yays + vote.nays}</span>
            </li>
        </ul>

        <div class="ballot" tal:repeat="ballot vote.ballots">
            <h3><div metal:use-macro="layout.macros['ballot_type']" tal:define="ballot_type ballot.type" /></h3>

            <div class="ballot-map"
                data-type="${ballot.type}"
                data-canton="${layout.app.principal.canton}"
                data-mapurl="${layout.get_topojson_link(layout.app.principal.canton, vote.date.year)}"
                data-dataurl="${request.link(ballot, name='by-municipality')}">
            </div>

            <table class="ballot-results stackable">
                <thead>
                    <th i18n:translate="">Electoral District</th>
                    <th i18n:translate="">Result</th>
                    <th i18n:translate="">Yays</th>
                    <th i18n:translate="">Nays</th>
                    <th i18n:translate="">Empty</th>
                    <th i18n:translate="">Invalid</th>
                    <th i18n:translate="">Yes %</th>
                    <th i18n:translate="">No %</th>
                </thead>
                <tbody>
                    <tr tal:repeat="result ballot.results">
                        <tal:block condition="not: result.counted">
                            <td colspan="8">${result.group}</td>
                        </tal:block>
                        <tal:block condition="result.counted">
                            <td>${result.group}</td>
                            <td class="accepted" tal:condition="result.accepted" i18n:translate="">Accepted</td>
                            <td class="rejected" tal:condition="not: result.accepted" i18n:translate="">Rejected</td>
                            <td>${result.yays}</td>
                            <td>${result.nays}</td>
                            <td>${result.empty}</td>
                            <td>${result.invalid}</td>
                            <td>${'{0:.2f}'.format(result.yays_percentage)}</td>
                            <td>${'{0:.2f}'.format(result.nays_percentage)}</td>
                        </tal:block>
                    </tr>
                </tbody>
            </table>
        </div>
    </tal:block>
</div>