<div metal:use-macro="layout.base" i18n:domain="onegov.election_day">
    <tal:block metal:fill-slot="before-content">
        <tal:block condition="not:vote.answer">
            <h1>
                ${vote.title}
            </h1>

            <hr />
        </tal:block>
        <tal:block condition="vote.answer">
            <h1>
                <small>
                    <div metal:use-macro="layout.macros['answer']" tal:define="answer vote.answer" />
                </small>
                ${vote.title}
            </h1>

            <div class="row">
                <div class="columns small-12 medium-6">
                    <dl>
                        <dd class="accepted" >${'{0:.2f}'.format(vote.yeas_percentage)}%</dd>
                        <dt i18n:translate="">Yeas</dt>
                    </dl>
                </div>
                <div class="columns small-12 medium-6 end">
                    <dl style="text-align: right;">
                        <dd class="rejected" >${'{0:.2f}'.format(vote.nays_percentage)}%</dd>
                        <dt i18n:translate="">Nays</dt>
                    </dl>
                </div>
            </div>

            <div class="percentage">
                <div class="yeas"></div>
                <div class="nays right" style="width:${'{0:.2f}'.format(vote.nays_percentage)}%"></div>
            </div>
        </tal:block>
    </tal:block>
    <tal:block metal:fill-slot="content">
        <ul class="small-block-grid-1 medium-block-grid-4 factoids">
            <li>
                <span i18n:translate="">Counted municipalities</span>
                <strong><span metal:use-macro="layout.macros['progress']" tal:define="progress vote.progress" /></strong>
            </li>
            <li>
                <span i18n:translate="">Elegible Voters</span>
                <strong>${layout.format_number(vote.elegible_voters)}</strong>
            </li>
            <li>
                <span i18n:translate="">Cast Ballots</span>
                <strong>${layout.format_number(vote.cast_ballots)}</strong>
            </li>
            <li>
                <span i18n:translate="">Turnout</span>
                <strong>${'{0:.2f}'.format(vote.turnout)} %</strong>
            </li>
        </ul>

        <tal:block tal:repeat="ballot vote.ballots">
            <div class="results-navigation" tal:condition="vote.counter_proposal" tal:define="types python: ['proposal', 'counter-proposal', 'tie-breaker']">
                <tal:block repeat="type types">
                    <h2 id="${ballot.type}" tal:condition="type == ballot.type">
                        <metal:type use-macro="layout.macros['ballot-type']" tal:define="ballot_type type" />
                    </h2>
                    <a href="#${type}" tal:condition="type != ballot.type">
                        <metal:type use-macro="layout.macros['ballot-type']" tal:define="ballot_type type" />
                    </a>
                </tal:block>
            </div>

            <h2 tal:condition="not:vote.counter_proposal" i18n:translate>
                Results
            </h2>

            <div class="row">
                <div class="small-12 small-centered medium-8 large-6 columns">
                    <div class="ballot-map"
                        data-type="${ballot.type}"
                        data-canton="${layout.app.principal.canton}"
                        data-mapurl="${layout.get_topojson_link(layout.app.principal.canton, vote.date.year)}"
                        data-dataurl="${request.link(ballot, name='by-municipality')}">

                        <div class="legend" data-left-hand="Yay" data-right-hand="Nay" i18n:attributes="data-left-hand; data-right-hand"></div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="small-12 columns">
                    <div>
                        <table class="ballot-results stackable">
                            <thead>
                                <th i18n:translate="">Electoral District</th>
                                <th i18n:translate="">Result</th>
                                <th i18n:translate="" class="right-aligned">Yeas</th>
                                <th i18n:translate="" class="right-aligned">Nays</th>
                                <th i18n:translate="" class="right-aligned">Empty</th>
                                <th i18n:translate="" class="right-aligned">Invalid</th>
                                <th i18n:translate="" class="right-aligned">Yes %</th>
                                <th i18n:translate="" class="right-aligned">No %</th>
                            </thead>
                            <tbody>
                                <tr tal:repeat="result ballot.results">
                                    <tal:block condition="not: result.counted">
                                        <td colspan="8">${result.group}</td>
                                    </tal:block>
                                    <tal:block condition="result.counted">
                                        <td>${result.group}</td>
                                        <td class="accepted" tal:condition="result.accepted" i18n:translate="">Accepted</td>
                                        <td class="rejected" tal:condition="not: result.accepted" i18n:translate="">Rejected</td>
                                        <td class="right-aligned">${layout.format_number(result.yeas)}</td>
                                        <td class="right-aligned">${layout.format_number(result.nays)}</td>
                                        <td class="right-aligned">${layout.format_number(result.empty)}</td>
                                        <td class="right-aligned">${layout.format_number(result.invalid)}</td>
                                        <td class="right-aligned">${layout.format_number(result.yeas_percentage)}</td>
                                        <td class="right-aligned">${layout.format_number(result.nays_percentage)}</td>
                                    </tal:block>
                                </tr>

                                <tr class="total">
                                    <td i18n:translate>Total</td>
                                    <td class="accepted" tal:condition="ballot.accepted" i18n:translate="">Accepted</td>
                                    <td class="rejected" tal:condition="not: ballot.accepted" i18n:translate="">Rejected</td>
                                    <td class="right-aligned">${layout.format_number(ballot.yeas)}</td>
                                    <td class="right-aligned">${layout.format_number(ballot.nays)}</td>
                                    <td class="right-aligned">${layout.format_number(ballot.empty)}</td>
                                    <td class="right-aligned">${layout.format_number(ballot.invalid)}</td>
                                    <td class="right-aligned">${layout.format_number(ballot.yeas_percentage)}</td>
                                    <td class="right-aligned">${layout.format_number(ballot.nays_percentage)}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </tal:block>
    </tal:block>
</div>
