<div metal:use-macro="layout.base" i18n:domain="onegov.election_day">
    <tal:block metal:fill-slot="title">
        ${title}
    </tal:block>
    <tal:block metal:fill-slot="body">

        <h1>${model_title}</h1>

        <p tal:condition="not model.has_results" i18n:translate>No results yet</p>

        <dl tal:condition="model.has_results and not model.completed and model.type == 'majorz'">

            <!--!
                Intermediate results, majorz
            -->
            <h2>Intermediate results</h2>

            <dt i18n:translate>Counted</dt>
            <dd><span metal:use-macro="layout.macros['progress']" tal:define="progress model.progress" /></dd>

            <dl tal:define="candidates python: sorted([(c.votes, c.family_name, c.first_name) for c in model.candidates], reverse=True)">
                <dt i18n:translate>Candidates</dt>
                <dd tal:repeat="candidate candidates">
                    ${candidate[1]} ${candidate[2]} ${layout.format_number(candidate[0])} <tal:block i18n:translate="single_votes">Votes</tal:block>
                </dd>
            </dl>
        </dl>

        <dl tal:condition="model.has_results and not model.completed and model.type == 'proporz'">

            <!--!
                Intermediate results, proporz
            -->
            <h2>Intermediate results</h2>

            <dt i18n:translate>Counted</dt>
            <dd><span metal:use-macro="layout.macros['progress']" tal:define="progress model.progress" /></dd>

            <dl tal:define="lists python: sorted([(l.votes, l.name) for l in model.lists], reverse=True)">
                <dt i18n:translate>Lists</dt>
                <dd tal:repeat="list lists">${list[1]} ${list[0]} <tal:block i18n:translate="single_votes">Votes</tal:block></dd>
            </dl>

        </dl>

        <tal:block tal:condition="model.has_results and model.completed and model.type == 'majorz'">

            <!--!
                Final results, majorz
            -->

            <dl>
                <dt i18n:translate>Elected Candidates</dt>
                <dd tal:repeat="name model.elected_candidates">${name[1]} ${name[0]}</dd>

                <dt i18n:translate>Turnout</dt>
                <dd>${'{0:.2f}'.format(model.turnout)} %</dd>
            </dl>
        </tal:block>

        <tal:block tal:condition="model.has_results and model.completed and model.type == 'proporz'">

            <!--!
                Final results, proporz
            -->

            <dl tal:define="lists python: sorted([(l.number_of_mandates, l.name) for l in model.lists if l.number_of_mandates], reverse=True)">
                <dt i18n:translate>Lists</dt>
                <dd tal:repeat="list lists">${list[1]} ${list[0]} <tal:block i18n:translate>Mandates</tal:block></dd>

                <dt i18n:translate>Elected Candidates</dt>
                <dd tal:repeat="name model.elected_candidates">${name[1]} ${name[0]}</dd>

                <dt i18n:translate>Turnout</dt>
                <dd>${'{0:.2f}'.format(model.turnout)} %</dd>
            </dl>
        </tal:block>

        <p><a href="${request.link(model)}">View all details online</a></p>

    </tal:block>
    <tal:block metal:fill-slot="footer">
        <p><a href="${optout}" i18n:translate>Unsubscribe</a></p>
    </tal:block>
</div>
