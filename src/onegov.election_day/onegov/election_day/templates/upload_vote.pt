<div metal:use-macro="layout.base" i18n:domain="onegov.election_day">
    <tal:block metal:fill-slot="title">
        ${title}
    </tal:block>
    <tal:block metal:fill-slot="content">
        <span class="shortcode large" tal:condition="shortcode|nothing">${shortcode}</span>
        <h1>${title}</h1>
        <h2 class="subheader">${subtitle}</h2>

        <tal:block condition="status == 'open'">
            <div class="panel">
                <i class="fa fa-info-circle"></i>
                <span i18n:translate="">Please use the following format:</span><br>

                <a href="${layout.format_description_link}" i18n:translate="">Format Description</a>
            </div>
        </tal:block>

        <div class="after-upload" tal:condition="status == 'success'">
            <div class="alert-box success" i18n:translate="">
                Your results were uploaded successfully.
            </div>

            <div tal:condition="layout.principal.notifications"  class="panel callout radius">
                <p>
                    <strong><a href="${request.link(vote, 'trigger')}" i18n:translate="">Click here to trigger the notifications</a></strong>
                </p>
            </div>

            <p>
                <a href="${request.link(vote)}" i18n:translate="">Click here to see the updated results page.</a>
            </p>

        </div>

        <div class="after-upload" tal:condition="status == 'error'">

            <div class="alert-box alert" i18n:translate="">
                Your results could not be uploaded.
            </div>

            <h3 class="success" tal:condition="'proposal' in results and results['proposal']['status'] == 'ok'"
                i18n:translate="">No errors found in proposal</h3>
            <h3 class="error" tal:condition="'proposal' in results and results['proposal']['status'] != 'ok'"
                i18n:translate="">Errors found in proposal</h3>
            <ul tal:condition="'proposal' in results">
                <li tal:repeat="error results['proposal']['errors']">
                    <span class="error-line" tal:condition="error.line"><span i18n:translate="">Line </span>${error.line}</span>
                    <span class="error-message">${error.error}</span>
                </li>
            </ul>

            <h3 class="success" tal:condition="'counter-proposal' in results and results['counter-proposal']['status'] == 'ok'"
                i18n:translate="">No errors found in counter proposal</h3>
            <h3 class="error" tal:condition="'counter-proposal' in results and results['counter-proposal']['status'] != 'ok'"
                i18n:translate="">Errors found in counter proposal</h3>
            <ul tal:condition="'counter-proposal' in results">
                <li tal:repeat="error results['counter-proposal']['errors']">
                    <span class="error-line" tal:condition="error.line"><span i18n:translate="">Line </span>${error.line}</span>
                    <span class="error-message">${error.error}</span>
                </li>
            </ul>

            <h3 class="success" tal:condition="'tie-breaker' in results and results['tie-breaker']['status'] == 'ok'"
                i18n:translate="">No errors found in tie-breaker</h3>
            <h3 class="error" tal:condition="'tie-breaker' in results and results['tie-breaker']['status'] != 'ok'"
                i18n:translate="">Errors found in tie-breaker</h3>
            <ul tal:condition="'tie-breaker' in results">
                <li tal:repeat="error results['tie-breaker']['errors']">
                    <span class="error-line" tal:condition="error.line"><span i18n:translate="">Line </span>${error.line}</span>
                    <span class="error-message">${error.error}</span>
                </li>
            </ul>
        </div>

        <div tal:condition="form.error_message|form.errors|nothing" data-alert class="alert-box alert">
            <tal:block tal:condition="not:form.error_message|nothing" i18n:translate="">The form contains errors. Please check the fields marked in red.</tal:block>
            <tal:block tal:condition="form.error_message|nothing" i18n:translate="">${form.error_message}</tal:block>
        </div>

        <div tal:condition="status != 'success'">
            <div metal:use-macro="layout.macros['form']" />
        </div>

    </tal:block>
</div>
