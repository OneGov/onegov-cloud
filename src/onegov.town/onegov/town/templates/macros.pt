<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      i18n:domain="onegov.town">
<body>

<metal:navigation define-macro="top_navigation">
    <nav class="top-bar" data-topbar role="navigation" tal:condition="layout.top_navigation">
        <ul class="title-area">
            <!--! this section needs to be included (even though it's empty),
            or the responsive menu bar icon won't be rendered -->
            <li class="name" style="width: 0;"></li>
            <li class="toggle-topbar menu-icon">
                <a href="#"><span>Menu</span></a>
            </li>
        </ul>
        <section class="top-bar-section">
            <ul class="left">
                <tal:block repeat="link layout.top_navigation">
                    <li>
                        <a tal:attributes="href link.url">${link.text}</a>
                    </li>
                </tal:block>
            </ul>
        </section>
    </nav>
</metal:navigation>

<metal:editbar define-macro="editbar">
    <div class="row" tal:condition="layout.editbar_links">
        <div class="small-12 columns">
            <div class="edit-bar clearfix">
                <tal:block repeat="group layout.editbar_links">
                    <tal:block condition="group.links" define="dropdown_id 'editbar-dropdown-{}'.format(repeat.group.number)">
                        <button href="#" data-dropdown="${dropdown_id}" class="tiny button dropdown">
                            ${group.title}
                        </button>
                        <ul id="${dropdown_id}" data-dropdown-content class="f-dropdown">
                            <li tal:repeat="link group.links">
                                <tal:block replace="structure link(request)" />
                            </li>
                        </ul>
                    </tal:block>
                </tal:block>
            </div>
        </div>
    </div>
</metal:editbar>

<metal:breadcrumbs define-macro="breadcrumbs">
    <ul class="breadcrumbs" tal:condition="layout.breadcrumbs">
        <tal:block repeat="link layout.breadcrumbs">
            <li tal:attributes="class repeat.link.end and 'current' or ''"
                tal:content="structure link(request)">
            </li>
        </tal:block>
    </ul>
</metal:breadcrumbs>

<metal:bottom_links define-macro="bottom-links">
    <ul class="bottom-links" tal:condition="layout.bottom_links">
        <li tal:repeat="link layout.bottom_links">
            <tal:block replace="structure link(request)"/>
        </li>
    </ul>
</metal:bottom_links>

<metal:search define-macro="form">
    <form tal:attributes="action form.action|'.';data-image-upload-url layout.image_upload_json_url; data-image-list-url layout.image_list_url" method="POST" enctype="multipart/form-data">
        <tal:block repeat="fieldset form.fieldsets">
            <fieldset tal:condition="fieldset.is_visible">
                <legend>${fieldset.label}</legend>
                <metal:fields use-macro="layout.macros['fields']" tal:define="fields fieldset.fields.values()" />
            </fieldset>
            <tal:block condition="not:fieldset.is_visible">
                <metal:fields use-macro="layout.macros['fields']" tal:define="fields fieldset.fields.values()" />
            </tal:block>
        </tal:block>
        <input type="submit" value="Submit" class="button" i18n:attributes="value">
    </form>
</metal:search>

<metal:fields define-macro="fields">
    <tal:block repeat="field fields">
        <div class="row"><div class="large-12 columns">
        <tal:block define="input_type field.widget.input_type|None">
            <tal:block condition="input_type == 'hidden'">
                ${field()}
                <small class="error" tal:repeat="error field.errors">${error}</small>
            </tal:block>
            <tal:block condition="input_type != 'hidden'">
                <label tal:attributes="class field.errors and 'error' or None">
                    <span class="label-text">${field.label.text}</span>
                    <span class="label-required" tal:condition="field.flags.required|nothing">*</span>
                    ${field(placeholder=request.translate(field.description))}
                </label>
                <small class="error" tal:repeat="error field.errors">${error}</small>
            </tal:block>
        </tal:block>
    </div></div>
    </tal:block>
</metal:fields>

<metal:dropzone define-macro="dropzone" i18n:domain="onegov.town">
    <form action="${layout.image_upload_url}"
          class="dropzone clearfix"
          method="POST"
          enctype="multipart/form-data">
        <div class="dz-message" i18n:translate="">
            Drop files to upload
        </div>

        <!--! Fallback if javascript is not available -->
        <div class="fallback">
            <input name="file" type="file" multiple />
            <input type="submit" value="Submit" class="button" i18n:attributes="value">
        </div>
    </form>
</metal:dropzone>

<metal:dropzone define-macro="newslist" i18n:domain="onegov.town">
    <div class="newslist" tal:condition="news">
        <div class="row news-list-item" tal:repeat="item news">
            <div class="small-12 columns">
                <a tal:attributes="href request.link(item)">
                    <h2>${item.title}</h2>
                </a>
                <p class="news-date">${item.created.strftime('%d.%m.%Y %H:%M')}</p>
                <p class="news-lead">${item.content.lead}</p>
                <p class="news-continue" tal:condition="item.content.text">
                    <a tal:attributes="href request.link(item)" i18n:translate="">read on...</a>
                </p>
            </div>
        </div>
    </div>
</metal:dropzone>

<metal:page_content define-macro="page_content" i18n:domain="onegov.town">
    <div class="row" tal:condition="lead | text">
        <div class="small-12 columns end">
            <em class="page-lead" tal:condition="lead" tal:content="lead" />
            <div class="page-text" tal:condition="text" tal:content="structure text" />
        </div>
    </div>
</metal:page_content>

</body>