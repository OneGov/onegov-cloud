<div metal:use-macro="layout.base" i18n:domain="onegov.town">
    <tal:block metal:fill-slot="title">
        ${title}
    </tal:block>
    <tal:block metal:fill-slot="content">
        <dl class="sub-nav ticket-filters" tal:define="base_link request.link(layout.model)">
            <dt i18n:translate class="show-for-sr">State:</dt>
            <tal:block repeat="link filters">
                <dd class="${link.active and 'active' or ''}">
                    <tal:block replace="structure link(request)"></tal:block>
                </dd>
            </tal:block>
        </dl>
        <div class="tickets table-list-header">
            <div class="table-list-header-cell state-open">
                ${layout.model.subset_count} ${tickets_title}
            </div>
        </div>
        <ul class="table-list">
            <li tal:repeat="ticket tickets">
                <tal:block tal:define="ticket_url request.link(ticket)">
                    <div class="table-list-cell ticket-number-plain">
                        <a href="${ticket_url}">
                            ${ticket.number}
                        </a>
                    </div>
                    <div class="table-list-cell ticket-title">
                        <a href="${ticket_url}">
                            ${ticket.title}
                        </a>
                        <div class="ticket-meta">
                          <span class="ticket-meta-section opened-by" tal:define="formatted layout.format_date(ticket.created, 'datetime')">
                              <span>${layout.format_date(ticket.created, 'relative')}</span>
                          </span>
                        </div>
                    </div>
                    <div class="table-list-cell ticket-group">
                        ${ticket.group}
                    </div>
                    <div class="table-list-cell table-list-cell-avatar">
                        <span tal:condition="ticket.user_id">
                            ${ticket.user.username}
                        </span>
                    </div>
                </tal:block>
            </li>
        </ul>
        <div class="pagination-centered">
            <div metal:use-macro="layout.macros['pagination']" tal:define="
            collection layout.model; current_page layout.model;" />
        </div>
    </tal:block>
</div>