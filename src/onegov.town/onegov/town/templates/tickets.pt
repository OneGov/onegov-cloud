<div metal:use-macro="layout.base" i18n:domain="onegov.town">
    <tal:block metal:fill-slot="title">
        ${title}
    </tal:block>
    <tal:block metal:fill-slot="content">
        <dl class="sub-nav tickets-filter">
            <dt i18n:translate>State:</dt>
            <tal:block repeat="link filters">
                <dd class="${link.active and 'active' or ''}">
                    <tal:block replace="structure link(request)"></tal:block>
                </dd>
            </tal:block>
        </dl>
        <table class="tickets-table">
            <thead>
                <tr>
                    <th colspan="6">${layout.model.subset_count} ${tickets_title}</th>
                </tr>
            </thead>
            <tbody>
                <tal:block repeat="ticket tickets">
                    <tr tal:define="ticket_url request.link(ticket)" class="ticket ticket-handler-${ticket.handler_code}">
                        <td class="ticket-number-plain">
                            <a href="${ticket_url}">
                                ${ticket.number}
                            </a>
                        </td>
                        <td class="ticket-group">
                            ${ticket.group}
                        </td>
                        <td class="ticket-title">
                            ${ticket.title}
                        </td>
                        <td class="ticket-date">
                            ${layout.format_date(ticket.created, 'relative')}
                        </td>
                        <td class="ticket-user">
                            <tal:block condition="ticket.user_id">
                                ${ticket.user.username}
                            </tal:block>
                        </td>
                        <td>
                            <tal:block condition="ticket.state == 'open'">
                                <a class="ticket-action ticket-accept" href="${request.link(ticket, 'accept')}" i18n:translate>
                                    Accept
                                </a>
                            </tal:block>
                        </td>
                    </tr>
                </tal:block>
            </tbody>
        </table>

        <div class="pagination-centered">
            <div metal:use-macro="layout.macros['pagination']" tal:define="
            collection layout.model; current_page layout.model;" />
        </div>
    </tal:block>
</div>