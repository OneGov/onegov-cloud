<div metal:use-macro="layout.base" i18n:domain="onegov.swissvotes" tal:define="vote layout.model">
    <tal:block metal:fill-slot="title">
        ${layout.title}
        <small tal:condition="vote.keyword">${vote.keyword}</small>
    </tal:block>
    <tal:block metal:fill-slot="content">
        <div class="vote">

            <ul class="pagination" role="menubar" aria-label="Pagination" i18n:attributes="aria-label">
                <li class="previous" tal:condition="prev">
                    <a href="${request.link(prev)}" i18n:translate>Previous vote</a>
                </li>
                <li class="next right" tal:condition="next">
                    <a href="${request.link(next)}" i18n:translate>Next vote</a>
                </li>
            </ul>

            <h2>${layout.title}<tal:block tal:condition="vote.keyword"> <small>${vote.keyword}</small></tal:block></h2>

            <div class="row">
                <div class="small-12 small-centered large-10 columns">
                    <figure>
                        <div class="bar-chart" data-dataurl="${request.link(vote, name='percentages')}"></div>
                    </figure>
                </div>
            </div>

            <table class="collapsible">
                <thead>
                    <tr><th colspan="2" i18n:translate>General</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <th class="column-30" i18n:translate>Title</th>
                        <td>${vote.title}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Keyword</th>
                        <td>${vote.keyword}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Vote date</th>
                        <td>${layout.format_date(vote.date, 'date')}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Legal form</th>
                        <td>${vote.legal_form}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Policy area</th>
                        <td>
                            <tal:block tal:repeat="area vote.policy_areas">
                                <tal:block tal:content="structure area.html(request)" /><br tal:condition="not repeat.area.end" />
                            </tal:block>
                        </td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Brief description Swissvotes</th>
                        <td></td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Description Ann√©e Politique Suisse</th>
                        <td><a href="${vote.anneepolitique}" tal:condition="vote.anneepolitique" i18n:translate>Link</a></td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Voting text</th>
                        <td><a tal:condition="voting_text" href="${request.link(voting_text)}" class="voting-text">PDF</a></td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Vote number</th>
                        <td>${layout.format_bfs_number(vote.bfs_number)}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Related votes</th>
                        <td></td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible" tal:condition="vote._legal_form == 3">
                <!--! (popular initiatives) -->
                <thead>
                    <tr><th colspan="2" i18n:translate>Submission</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <th class="column-30" i18n:translate>Initiator</th>
                        <td>${vote.initiator}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Signatures</th>
                        <td>${layout.format_number(vote.signatures_valid)}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Collection duration</th>
                        <td>
                            <tal:block tal:condition="vote.duration_initative_collection">
                                ${layout.format_number(vote.duration_initative_collection)} <tal:block i18n:translate>Days</tal:block>
                            </tal:block>
                        </td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Realization</th>
                        <td><a tal:condition="realization" href="${request.link(realization)}" class="realization">PDF</a></td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible">
                <thead>
                    <tr><th colspan="2" i18n:translate>Pre-parliamentary phase</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <th class="column-30" i18n:translate>Federal council message</th>
                        <td><a tal:condition="federal_council_message" href="${request.link(federal_council_message)}" class="federal-council-message">PDF</a></td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Position of the Federal Council</th>
                        <td>${vote.position_federal_council}</td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible">
                <thead>
                    <tr><th colspan="2" i18n:translate>Parliamentary phase</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <th class="column-30" i18n:translate>Procedure number</th>
                        <td>${layout.format_procedure_number(vote.procedure_number)}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Parliamentary debate</th>
                        <td><a tal:condition="parliamentary_debate" href="${request.link(parliamentary_debate)}" class="parliamentary-debate">PDF</a></td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Duration in Parliament</th>
                        <td>
                            <tal:block tal:condition="vote.duration_federal_assembly">
                                ${layout.format_number(vote.duration_federal_assembly)} <tal:block i18n:translate>Days</tal:block>
                            </tal:block>
                        </td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Parliament's position</th>
                        <td>${vote.position_parliament}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Position of the National Council</th>
                        <td>
                            ${vote.position_national_council}
                            <tal:block tal:condition="vote.position_national_council_yeas is not None and vote.position_national_council_nays is not None">
                                (${vote.position_national_council_yeas} <tal:block i18n:translate>Yea</tal:block>, ${vote.position_national_council_nays} <tal:block i18n:translate>Nay</tal:block>)
                            </tal:block>
                        </td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Position of the Council of States</th>
                        <td>
                            ${vote.position_council_of_states}
                            <tal:block tal:condition="vote.position_council_of_states_yeas is not None and vote.position_council_of_states_nays is not None">
                                (${vote.position_council_of_states_yeas} <tal:block i18n:translate>Yea</tal:block>, ${vote.position_council_of_states_nays} <tal:block i18n:translate>Nay</tal:block>)
                            </tal:block>
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible" tal:condition="vote._legal_form == 2">
                <!--! optional referendum -->
                <thead>
                    <tr><th colspan="2" i18n:translate>Submission</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <th class="column-30" i18n:translate>Initiator</th>
                        <td>${vote.initiator}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Signatures</th>
                        <td>${layout.format_number(vote.signatures_valid)}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Collection duration</th>
                        <td>
                            <tal:block tal:condition="vote.duration_referendum_collection">
                                ${layout.format_number(vote.duration_referendum_collection)} <tal:block i18n:translate>Days</tal:block>
                            </tal:block>
                        </td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Realization</th>
                        <td><a tal:condition="realization" href="${request.link(realization)}" class="realization">PDF</a></td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible">
                <thead>
                    <tr><th colspan="2" i18n:translate>Voting campaign</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <th class="column-30" i18n:translate>Voting booklet</th>
                        <td><a tal:condition="voting_booklet" href="${request.link(voting_booklet)}" class="voting-booklet">PDF</a></td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Recommendations of the Parties</th>
                        <td>
                            <dl tal:repeat="(recommendation, parties) vote.recommendations_parties.items()">
                                <dt>${recommendation}</dt>
                                <dd tal:repeat="party parties"><tal:block tal:content="structure party.html(request)" /></dd>
                            </dl>
                        </td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Voter share of yes camp</th>
                        <td>
                            <tal:block tal:condition="vote.has_national_council_share_data">
                                <tal:block tal:condition="vote.national_council_share_yeas is not None">
                                    ${layout.format_number(vote.national_council_share_yeas, 1)}%
                                </tal:block>
                                <tal:block tal:condition="vote.national_council_share_yeas is None">?</tal:block>
                                (<a href="${request.link(vote, 'strengths')}" i18n:translate>Details</a>)
                            </tal:block>
                            <tal:block tal:condition="not vote.has_national_council_share_data">
                                <tal:block tal:condition="vote.national_council_share_yeas is not None">
                                    ${layout.format_number(vote.national_council_share_yeas, 1)}%
                                </tal:block>
                            </tal:block>
                        </td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Further Recommendations</th>
                        <td>
                            <dl tal:repeat="(recommendation, associations) vote.recommendations_associations.items()">
                                <dt>${recommendation}</dt>
                                <dd tal:repeat="association associations"><tal:block tal:content="structure association.html(request)" /></dd>
                            </dl>
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible">
                <thead>
                    <tr><th colspan="2" i18n:translate>Vote</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <th class="column-30" i18n:translate>Voting result</th>
                        <td>${vote.result}</td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>People</th>
                        <td>
                            ${vote.result_people_accepted}
                            <tal:block tal:condition="vote.result_people_yeas_p">
                                (${layout.format_number(vote.result_people_yeas_p, 2)}% <tal:block i18n:translate>Yeas</tal:block>)
                            </tal:block>
                        </td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Cantons</th>
                        <td>
                            <span class="result-cantons-accepted">
                                ${vote.result_cantons_accepted}
                                <tal:block tal:condition="vote.result_cantons_yeas and vote.result_cantons_nays and vote._result_cantons_accepted != 3">
                                    (${layout.format_number(vote.result_cantons_yeas, 1)} <tal:block i18n:translate>Yea</tal:block>, ${layout.format_number(vote.result_cantons_nays, 1)} <tal:block i18n:translate>Nay</tal:block>)
                                </tal:block>
                            </span>
                            <dl tal:repeat="(result, cantons) vote.results_cantons.items()">
                                <dt>${result}</dt>
                                <dd tal:repeat="canton cantons"><tal:block tal:content="structure canton.html(request)" /></dd>
                            </dl>
                        </td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Turnout</th>
                        <td><tal:block tal:condition="vote.result_turnout">${layout.format_number(vote.result_turnout, 2)}%</tal:block></td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Resolution</th>
                        <td><a tal:condition="resolution" href="${request.link(resolution)}" class="resolution">PDF</a></td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Result by canton, district and municipality</th>
                        <td></td>
                    </tr>
                    <tr>
                        <th class="column-30" i18n:translate>Interactive map</th>
                        <td></td>
                    </tr>
                </tbody>
            </table>

        </div>
    </tal:block>
</div>
