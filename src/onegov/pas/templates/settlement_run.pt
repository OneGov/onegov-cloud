<div metal:use-macro="layout.base" i18n:domain="onegov.pas">
    <tal:b metal:fill-slot="title">
            ${title}
    </tal:b>

    <tal:b metal:fill-slot="content">
        <dl class="field-display">
            <div>
                <dt i18n:translate="">Start</dt>
                <dd>${layout.format_date(settlement_run.start, 'date')}</dd>
            </div>
            <div>
                <dt i18n:translate="">End</dt>
                <dd>${layout.format_date(settlement_run.end, 'date')}</dd>
            </div>
            <div>
                <dt i18n:translate="">Active</dt>
                <dd tal:condition="settlement_run.active" i18n:translate="">Yes</dd>
                <dd tal:condition="not settlement_run.active" i18n:translate="">No</dd>
            </div>
        </dl>

        <!-- Closure Status Control List -->
        <div tal:condition="closure_status" class="closure-status-section">
            <hr class="short-hr">
            <h3 i18n:translate="">Commission Closure Status</h3>
            <hr class="long-hr">

            <table class="closure-status-table">
                <thead>
                    <tr>
                        <th i18n:translate="">Parliamentarian</th>
                        <th tal:repeat="commission_name python:sorted(set().union(*[commissions.keys() for commissions in closure_status.values()])) if closure_status else []">
                            ${commission_name}
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr tal:repeat="parliamentarian_item closure_status.items()">
                        <td tal:define="parliamentarian_name python:parliamentarian_item[0]; commissions python:parliamentarian_item[1]">
                            ${parliamentarian_name}
                        </td>
                        <td tal:repeat="commission_name python:sorted(set().union(*[commissions.keys() for commissions in closure_status.values()])) if closure_status else []"
                            tal:define="is_closed python:commissions.get(commission_name, False)"
                            class="${python:'closed' if is_closed else 'not-closed'}">
                            <span tal:condition="is_closed" class="closure-indicator closed">✓</span>
                            <span tal:condition="not is_closed" class="closure-indicator not-closed">✗</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Tabs Start -->
        <ul class="tabs" data-tabs id="settlement-run-export-tabs" role="tablist">
            <tal:block tal:repeat="tab_item export_tabs_data.values()">
                <li tal:attributes="class python:'tabs-title ' + ('is-active' if repeat.tab_item.index == 0 else '')" role="presentation">
                    <a tal:attributes="href '#' + tab_item.panel_id;
                                       aria-controls tab_item.panel_id;
                                       aria-selected 'true' if repeat.tab_item.index == 0 else 'false'"
                       role="tab">${tab_item.tab_title}</a>
                </li>
            </tal:block>
        </ul>

        <div class="tabs-content" data-tabs-content="settlement-run-export-tabs">
            <tal:block tal:repeat="tab_item export_tabs_data.values()">
                <div tal:attributes="class python:'tabs-panel ' + ('is-active' if repeat.tab_item.index == 0 else '');
                                   id tab_item.panel_id"
                     role="tabpanel">
                    <div tal:repeat="category_key tab_item.categories.keys()" class="export-category">
                        <tal:block tal:define="category tab_item.categories[category_key]">
                            <div class="category-container">
                                <hr class="short-hr">
                                <h3 class="export-category-title">${category.title}</h3>
                                <hr class="long-hr">
                            </div>
                            <div class="link-container">
                                <tal:b repeat="link category.links">
                                    <span class="link-item" tal:content="link(layout)"></span>
                                </tal:b>
                            </div>
                        </tal:block>
                    </div>
                </div>
            </tal:block>
        </div>
        <!-- Tabs End -->

    </tal:b>

</div>
