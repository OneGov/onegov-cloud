<div metal:use-macro="layout.base" i18n:domain="onegov.swissvotes" tal:define="vote layout.model">
    <tal:block metal:fill-slot="title">${layout.title}</tal:block>
    <tal:block metal:fill-slot="content">
        <div class="vote">

            <ul class="pagination" role="menubar" aria-label="Pagination" i18n:attributes="aria-label">
                <li class="previous" tal:condition="prev">
                    <a href="${request.link(prev)}" i18n:translate>Previous vote</a>
                </li>
                <li class="next right" tal:condition="next">
                    <a href="${request.link(next)}" i18n:translate>Next vote</a>
                </li>
            </ul>

            <h2>${layout.title}<tal:block tal:condition="vote.keyword"> <small>${vote.keyword}</small></tal:block></h2>

            <div class="row">
                <div class="small-12 small-centered large-10 columns">
                    <figure>
                        <div class="bar-chart" data-dataurl="${request.link(vote, name='percentages')}"></div>
                    </figure>
                </div>
            </div>

            <table class="collapsible">
                <thead>
                    <tr><th colspan="2" i18n:translate>General</th></tr>
                </thead>
                <tbody>
                    <tr tal:condition="vote.title">
                        <th class="column-30" i18n:translate>Official title</th>
                        <td>${vote.title}</td>
                    </tr>
                    <tr tal:condition="vote.keyword">
                        <th class="column-30" i18n:translate>Keyword</th>
                        <td>${vote.keyword}</td>
                    </tr>
                    <tr tal:condition="vote.date">
                        <th class="column-30" i18n:translate>Vote date</th>
                        <td>${layout.format_date(vote.date, 'date')}</td>
                    </tr>

                    <tr tal:condition="vote.result">
                        <th class="column-30" i18n:translate>Voting result</th>
                        <td>
                            ${vote.result} (${layout.format_number(vote.result_people_yeas_p, 2)}<tal:block i18n:translate>% Yes votes</tal:block><tal:block tal:condition="vote._result_cantons_accepted != 3"> <tal:block i18n:translate> and <span tal:replace="vote.result_cantons_yeas" i18n:name="number" /> out of <span tal:replace="vote.number_of_cantons" i18n:name="total" /> votes of the Cantons</tal:block></tal:block>)
                        </td>
                    </tr>

                    <tr tal:condition="vote.bfs_number is not None">
                        <th class="column-30" i18n:translate>Vote number</th>
                        <td>${layout.format_bfs_number(vote.bfs_number)}</td>
                    </tr>
                    <tr tal:condition="vote.legal_form is not None">
                        <th class="column-30" i18n:translate>Legal form</th>
                        <td>${vote.legal_form}</td>
                    </tr>
                    <tr tal:condition="vote.policy_areas">
                        <th class="column-30" i18n:translate>Policy area</th>
                        <td>
                            <tal:block tal:repeat="area vote.policy_areas">
                                <tal:block tal:content="area.html(request)" /><br tal:condition="not repeat.area.end" />
                            </tal:block>
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['brief_description']">
                        <th class="column-30" i18n:translate>Brief description Swissvotes</th>
                        <td>
                            <a href="${layout.attachments['brief_description']['url']}" target="_blank" class="brief-description">PDF</a>
                            <span tal:condition="request.html_lang == 'de-CH' and vote.brief_description_title">&laquo;${vote.brief_description_title}&raquo;</span>
                            <tal:block metal:use-macro="layout.macros['attachment_locale']" tal:define="name 'brief_description'" />
                        </td>
                    </tr>

                    <tr tal:condition="vote.anneepolitique">
                        <th class="column-30" i18n:translate>Description Année Politique Suisse</th>
                        <td>
                            <a href="${vote.anneepolitique}" target="_blank" i18n:translate>Link</a> <span tal:condition="request.html_lang == 'en-US'">(in German / French)</span>
                            </td>
                    </tr>
                    <tr tal:condition="layout.attachments['voting_text']">
                        <th class="column-30" i18n:translate>Voting text</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'voting_text'" />
                        </td>
                    </tr>
                    <tr tal:condition="vote.link_bk_chrono">
                        <th class="column-30" i18n:translate>Official Chronology</th>
                        <td>
                            <a href="${vote.link_bk_chrono}" target="_blank" class="bk_chrono" i18n:translate>Link</a> <span tal:condition="request.html_lang == 'en-US'">(in German)</span>
                        </td>
                    </tr>
                    <tr tal:condition="False">
                        <th class="column-30" i18n:translate>Related votes</th>
                        <td></td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible" tal:condition="vote._legal_form == 3">
                <!--! (popular initiatives) -->
                <thead>
                    <tr><th colspan="2" i18n:translate>Submission</th></tr>
                </thead>
                <tbody>
                    <tr tal:condition="vote.initiator">
                        <th class="column-30" i18n:translate>Initiator</th>
                        <td>${vote.initiator}</td>
                    </tr>
                    <tr tal:condition="layout.attachments['preliminary_examination']">
                        <th class="column-30" i18n:translate>Preliminary examination</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'preliminary_examination'" />
                        </td>
                    </tr>
                    <tr tal:condition="vote.signatures_valid is not None">
                        <th class="column-30" i18n:translate>Signatures</th>
                        <td>${layout.format_number(vote.signatures_valid)}</td>
                    </tr>
                    <tr tal:condition="vote.duration_initative_collection is not None">
                        <th class="column-30">
                            <span i18n:translate>Collection duration</span>
                            <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="Number of days between the start of collecting signatures and their filing by the initiators"><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td>${layout.format_number(vote.duration_initative_collection)} <tal:block i18n:translate>Days</tal:block></td>
                    </tr>
                    <tr tal:condition="layout.attachments['realization']">
                        <th class="column-30" i18n:translate>Realization</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'realization'" />
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible" tal:condition="vote._parliamentary_initiated != 1">
                <thead>
                    <tr><th colspan="2" i18n:translate>Pre-parliamentary phase</th></tr>
                </thead>
                <tbody>
                    <tr tal:condition="layout.attachments['federal_council_message']">
                        <th class="column-30" i18n:translate>Federal council message</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'federal_council_message'" />
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible">
                <thead>
                    <tr><th colspan="2" i18n:translate>Parliamentary phase</th></tr>
                </thead>
                <tbody>
                    <tr tal:condition="vote.procedure_number">
                        <th class="column-30" i18n:translate>Procedure number</th>
                        <td>${vote.procedure_number}</td>
                    </tr>
                    <tr tal:condition="layout.attachments['parliamentary_initiative']">
                        <th class="column-30" i18n:translate>Parliamentary initiative</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'parliamentary_initiative'" />
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['parliamentary_committee_report']">
                        <th class="column-30" i18n:translate>Report of the parliamentary committee</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'parliamentary_committee_report'" />
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['federal_council_opinion']">
                        <th class="column-30" i18n:translate>Opinion of the Federal Council</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'federal_council_opinion'" />
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['parliamentary_debate'] or vote.link_curia_vista">
                        <th class="column-30" i18n:translate>Parliamentary debate</th>
                        <td>
                            <a href="${layout.attachments['parliamentary_debate']['url']}" target="_blank" class="parliamentary-debate" tal:condition="layout.attachments['parliamentary_debate']">PDF</a>
                            <tal:b condition="layout.attachments['parliamentary_debate'] and vote.link_curia_vista">
                                /
                            </tal:b>
                            <tal:b condition="vote.link_curia_vista">
                                <a href="${vote.link_curia_vista}" target="_blank" i18n:translate>Link</a>
                                <span tal:condition="request.html_lang == 'en-US'">
                                    (in German / French)
                                </span>
                            </tal:b>
                        </td>
                    </tr>
                    <tr tal:condition="vote.duration_federal_assembly is not None">
                        <th class="column-30">
                          <span i18n:translate>Duration in Parliament</span>
                          <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="Number of days between the Federal Council dispatch and the Parliament’s final vote"><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td>${layout.format_number(vote.duration_federal_assembly)} <tal:block i18n:translate>Days</tal:block></td>
                    </tr>
                    <tr tal:condition="vote.position_parliament">
                        <th class="column-30" i18n:translate>Parliament's position</th>
                        <td>${vote.position_parliament}</td>
                    </tr>
                    <tr tal:condition="vote.position_national_council">
                        <th class="column-30" i18n:translate>Position of the National Council</th>
                        <td>
                            ${vote.position_national_council}
                            <tal:block tal:condition="vote.position_national_council_yeas is not None and vote.position_national_council_nays is not None">
                                <tal:b tal:switch="vote._legal_form == 5">
                                    <tal:b tal:case="False">
                                        (${vote.position_national_council_yeas} <tal:block i18n:translate>Yea</tal:block>, ${vote.position_national_council_nays} <tal:block i18n:translate>Nay</tal:block>)
                                    </tal:b>
                                    <tal:b tal:case="True">
                                        (${vote.position_national_council_yeas} <tal:block i18n:translate>for the popular initiative</tal:block>, ${vote.position_national_council_nays} <tal:block i18n:translate>for the counter-proposal</tal:block>)
                                    </tal:b>
                                </tal:b>
                            </tal:block>
                        </td>
                    </tr>
                    <tr tal:condition="vote.position_council_of_states">
                        <th class="column-30" i18n:translate>Position of the Council of States</th>
                        <td>
                            ${vote.position_council_of_states}
                            <tal:block tal:condition="vote.position_council_of_states_yeas is not None and vote.position_council_of_states_nays is not None">
                                <tal:b tal:switch="vote._legal_form == 5">
                                    <tal:b tal:case="False">
                                        (${vote.position_council_of_states_yeas} <tal:block i18n:translate>Yea</tal:block>, ${vote.position_council_of_states_nays} <tal:block i18n:translate>Nay</tal:block>)
                                    </tal:b>
                                    <tal:b tal:case="True">
                                        (${vote.position_council_of_states_yeas} <tal:block i18n:translate>for the popular initiative</tal:block>, ${vote.position_council_of_states_nays} <tal:block i18n:translate>for the counter-proposal</tal:block>)
                                    </tal:b>
                                </tal:b>
                            </tal:block>
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible" tal:condition="vote._legal_form == 2">
                <!--! optional referendum -->
                <thead>
                    <tr><th colspan="2" i18n:translate>Submission</th></tr>
                </thead>
                <tbody>
                    <tr tal:condition="vote.initiator">
                        <th class="column-30" i18n:translate>Initiator</th>
                        <td>${vote.initiator}</td>
                    </tr>
                    <tr tal:condition="vote.signatures_valid is not None">
                        <th class="column-30" i18n:translate>Signatures</th>
                        <td>${layout.format_number(vote.signatures_valid)}</td>
                    </tr>
                    <tr tal:condition="vote.duration_referendum_collection is not None">
                        <th class="column-30">
                            <span i18n:translate>Collection duration</span>
                            <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="Number of days from the start of the collection period (publication of the parliamentary decision) until the submission of signatures."><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td>${layout.format_number(vote.duration_referendum_collection)} <tal:block i18n:translate>Days</tal:block></td>
                    </tr>
                    <tr tal:condition="layout.attachments['realization']">
                        <th class="column-30" i18n:translate>Realization</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'realization'" />
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible">
                <thead>
                    <tr><th colspan="2" i18n:translate>Voting campaign</th></tr>
                </thead>
                <tbody>
                    <tr tal:condition="layout.attachments['voting_booklet']">
                        <th class="column-30" i18n:translate>Voting booklet</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'voting_booklet'" />
                        </td>
                    </tr>
                    <tr tal:condition="vote._position_federal_council">
                        <th class="column-30" i18n:translate>Position of the Federal Council</th>
                        <td>${vote.position_federal_council}</td>
                    </tr>
                    <tr tal:condition="vote.link_federal_council or vote.link_federal_departement or vote.link_federal_office">
                        <th class="column-30">
                            <tal:block i18n:translate>Online information by the federal authorities</tal:block>
                            <span data-tooltip aria-haspopup="true" class="has-tip" i18n:attributes="title" title="For future votes, links to the current versions of the websites are provided here. For past votes, the links lead to the archived versions of the websites so as to show the status prior to the respective vote."><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td class="inline-links">
                            <a tal:condition="vote.link_federal_council" href="${vote.link_federal_council}" target="_blank" i18n:translate>Link Federal Council</a>
                            <a tal:condition="vote.link_federal_departement" href="${vote.link_federal_departement}" target="_blank" i18n:translate>Link department</a>
                            <a tal:condition="vote.link_federal_office" href="${vote.link_federal_office}" target="_blank" i18n:translate>Link federal office</a>
                        </td>
                    </tr>
                    <tr tal:condition="vote.link_easyvote">
                        <th class="column-30" i18n:translate>Explainer video by easyvote</th>
                        <td>
                            <a href="${vote.link_easyvote}" target="_blank" i18n:translate>Link</a> <span tal:condition="request.html_lang == 'en-US'">(in German)</span>
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['easyvote_booklet']">
                        <th class="column-30" i18n:translate>Explanatory brochure by easyvote</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'easyvote_booklet'" />
                        </td>
                    </tr>
                    <tr tal:condition="vote.campaign_links">
                        <th class="column-30">
                            <tal:block i18n:translate>Campaign websites</tal:block>
                            <span data-tooltip aria-haspopup="true" class="has-tip" i18n:attributes="title" title="The links lead to the archived versions of the websites so as to show the status prior to the respective vote."><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td>
                            <dl tal:repeat="(label, links) vote.campaign_links.items()" class="campaign-links">
                                <dt i18n:translate>${label}</dt>
                                <dd tal:repeat="link links">
                                    <a href="${link}" target="_blank"><tal:block i18n:translate>Link</tal:block><tal:block tal:condition="repeat.link.length > 1"> ${repeat.link.index + 1}</tal:block></a>
                                </dd>
                            </dl>
                        </td>
                    </tr>
                    <tr tal:condition="vote.recommendations_parties">
                        <th class="column-30" i18n:translate>Recommendations of the Parties</th>
                        <td>
                            <dl tal:repeat="(recommendation, parties) vote.recommendations_parties.items()" class="recommendation">
                                <dt>${recommendation}</dt>
                                <dd tal:repeat="party parties"><tal:block tal:content="party.html(request)" /></dd>
                            </dl>
                        </td>
                    </tr>
                    <tr tal:condition="vote.national_council_share_yeas is not None or vote.has_national_council_share_data">
                        <th class="column-30">
                            <tal:b tal:switch="vote._legal_form == 5">
                                <tal:b tal:case="False">
                                    <span i18n:translate>Voter share of yes camp</span>
                                    <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="Cumulated electoral share of the parties which recommend to vote Yes"><i class="fa fa-info" aria-hidden="true"></i></span>
                                </tal:b>
                                <tal:b tal:case="True">
                                    <span i18n:translate>Electoral share of pro-initiative camp</span>
                                    <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="Cumulated electoral share of the parties which recommend to prefer the popular initiative"><i class="fa fa-info" aria-hidden="true"></i></span>
                                </tal:b>
                            </tal:b>
                        </th>
                        <td>
                            <tal:block tal:condition="vote.has_national_council_share_data">
                                <tal:block tal:condition="vote.national_council_share_yeas is not None">
                                    ${layout.format_number(vote.national_council_share_yeas, 1)}%
                                </tal:block>
                                <tal:block tal:condition="vote.national_council_share_yeas is None">?</tal:block>
                                (<a href="${request.link(vote, 'strengths')}" i18n:translate>Details</a>)
                            </tal:block>
                            <tal:block tal:condition="not vote.has_national_council_share_data">
                                <tal:block tal:condition="vote.national_council_share_yeas is not None">
                                    ${layout.format_number(vote.national_council_share_yeas, 1)}%
                                </tal:block>
                            </tal:block>
                        </td>
                    </tr>
                    <tr tal:condition="vote.recommendations_associations">
                        <th class="column-30" i18n:translate>Further Recommendations</th>
                        <td>
                            <dl tal:repeat="(recommendation, associations) vote.recommendations_associations.items()" class="recommendation">
                                <dt>${recommendation}</dt>
                                <dd tal:repeat="association associations"><tal:block tal:content="association.html(request)" /></dd>
                            </dl>
                        </td>
                    </tr>
                    <tr tal:condition="vote.recommendations_divergent_parties">
                        <th class="column-30" i18n:translate>Divergent branches</th>
                        <td>
                            <dl tal:repeat="(recommendation, branches) vote.recommendations_divergent_parties.items()"  class="recommendation">
                                <dt>${recommendation}</dt>
                                <dd tal:repeat="(actor, canton) branches"><tal:block tal:content="actor.html(request)" /> <tal:block tal:content="canton.html(request)" /></dd>
                            </dl>
                        </td>
                    </tr>
                    <tr tal:condition="vote.media_ads_total">
                        <th class="column-30">
                          <span i18n:translate>Number of adverts in print media</span>
                          <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="Total number of adverts on the vote published in some 50 print media outlets in the last 8 weeks before voting day (intensity of the advertising campaign). For more details, see the analysis of the advertising campaign by Année Politique Suisse."><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td>${layout.format_number(vote.media_ads_total)}</td>
                    </tr>
                    <tr tal:condition="vote.media_ads_yea_p">
                        <th class="column-30">
                          <span i18n:translate>Percentage of adverts for a 'yes'</span>
                          <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="Percentage of adverts canvassing a 'yes' vote. A figure of over 50% indicates that more adverts for a 'yes' than for a 'no' were placed. For more details, see the analysis of the advertising campaign by Année Politique Suisse."><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td>${layout.format_number(vote.media_ads_yea_p, 0)}%</td>
                    </tr>
                    <tr tal:condition="layout.attachments['ad_analysis']">
                        <th class="column-30" i18n:translate>Analysis of the advertising campaign by Année Politique</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'ad_analysis'" />
                        </td>
                    </tr>
                    <tr tal:condition="vote.media_coverage_articles_total">
                        <th class="column-30">
                          <span i18n:translate>Media coverage: number of articles</span>
                          <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="Number of media articles on the vote that appeared in a selection of media outlets in the last 12 weeks before voting day. Hence, this indicator measures the intensity of media coverage of the vote. For more details, see the fög analysis report."><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td>${layout.format_number(vote.media_coverage_articles_total)}</td>
                    </tr>
                    <tr tal:condition="vote.media_coverage_tonality_total">
                        <th class="column-30">
                          <span i18n:translate>Media coverage: tonality</span>
                          <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="A positive figure means that the ‘yes’ position was covered more broadly than the ‘no’ position in the analysed media outlets. A negative figure means that the ‘no’ position prevailed in the analysed media sample. The tonality indicator can range from -100 (all media coverage was negative) to +100 (all media coverage was positive). For more details, see the fög analysis report."><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td>${layout.format_number(vote.media_coverage_tonality_total, 0)}
                          <span i18n:translate tal:condition="vote.media_coverage_tonality_total > 0">(predominantly positive)</span>
                          <span i18n:translate tal:condition="vote.media_coverage_tonality_total < 0">(predominantly negative)</span>
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['foeg_analysis']">
                        <th class="column-30" i18n:translate>Media coverage: fög analysis</th>
                        <td>
                            <a href="${layout.attachments['foeg_analysis']['url']}" target="_blank" class="foeg-analysis">PDF</a> /
                            <a href="https://www.foeg.uzh.ch/de/research/projects/abstimmungsmonitor.html" target="_blank" i18n:translate>Link</a> <span tal:condition="request.html_lang == 'en-US'">(in German)</span>
                            <span tal:condition="request.html_lang == 'fr-CH'">(en allemand)</span>
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['campaign_finances_xlsx'] or vote.campaign_finances_link or vote.campaign_finances_yea_total or vote.campaign_finances_nay_total">
                        <th class="column-30">
                            <tal:block i18n:translate>Campaign finances</tal:block>
                            <span data-tooltip aria-haspopup="true" class="has-tip" i18n:attributes="title" title="This information has been taken from the website of the Swiss Federal Audit Office, which for its part points out that the data is published in the form in which it was reported to the SFAO by the actors subject to disclosure requirements.<br><br>Total receipts and largest donors are shown according to the final statement, which is published 75 days after the vote"><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td>
                            <div class="campaign-finances" tal:condition="layout.attachments['campaign_finances_xlsx'] or vote.campaign_finances_link">
                                <a tal:condition="layout.attachments['campaign_finances_xlsx']" href="${layout.attachments['campaign_finances_xlsx']['url']}" target="_blank">Excel</a>
                                <tal:block tal:condition="layout.attachments['campaign_finances_xlsx'] and vote.campaign_finances_link">/</tal:block>
                                <a tal:condition="vote.campaign_finances_link" href="${vote.campaign_finances_link}" target="_blank" i18n:translate>Link</a>
                                <span tal:condition="request.html_lang == 'en-US'">(in German)</span>
                            </div>
                            <div class="campaign-finances" tal:condition="vote.campaign_finances_yea_total">
                                <tal:block i18n:translate>Total receipts of ‘yes’ campaign:</tal:block> CHF ${layout.format_number(vote.campaign_finances_yea_total)}<tal:block tal:condition="vote.campaign_finances_yea_donors">,
                                    <tal:block i18n:translate>largest donors:</tal:block> ${vote.campaign_finances_yea_donors}
                                </tal:block>
                            </div>
                            <div class="campaign-finances" tal:condition="vote.campaign_finances_nay_total">
                                <tal:block i18n:translate>Total receipts of ‘no’ campaign:</tal:block> CHF ${layout.format_number(vote.campaign_finances_nay_total)}<tal:block tal:condition="vote.campaign_finances_nay_donors">,
                                    <tal:block i18n:translate>largest donors:</tal:block> ${vote.campaign_finances_nay_donors}
                                </tal:block>
                            </div>
                        </td>
                    </tr>
                    <tr tal:condition="vote.campaign_material_other">
                        <th class="column-30" i18n:translate="">Documents from the campaign</th>
                        <td>
                            <a href="${request.link(vote, name='campaign-material')}" i18n:translate="">Display the list of documents</a>
                        </td>
                    </tr>
                    <tr tal:condition="posters['yea']">
                        <th class="column-30" i18n:translate="">Graphical campaign material for a Yes</th>
                        <td>
                            <tal:b metal:use-macro="layout.macros['image_gallery']" tal:define="items posters['yea']; id_suffix 'yea'" />
                        </td>
                    </tr>
                    <tr tal:condition="posters['nay']">
                        <th class="column-30" i18n:translate="">Graphical campaign material for a No</th>
                        <td>
                            <tal:b metal:use-macro="layout.macros['image_gallery']" tal:define="items posters['nay']; id_suffix 'nay'" />
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible">
                <thead>
                    <tr><th colspan="2" i18n:translate>Vote</th></tr>
                </thead>
                <tbody>
                    <tr tal:condition="vote.result">
                        <th class="column-30" i18n:translate>Voting result</th>
                        <td>${vote.result}</td>
                    </tr>
                    <tr tal:condition="vote.result_people_accepted">
                        <th class="column-30" i18n:translate>People</th>
                        <td>
                            ${vote.result_people_accepted}
                            <tal:block tal:condition="vote.result_people_yeas_p">
                                <tal:b tal:switch="vote._legal_form == 5">
                                    <tal:b tal:case="False">
                                        (${layout.format_number(vote.result_people_yeas_p, 2)}<tal:b i18n:translate>% Yes votes</tal:b>)
                                    </tal:b>
                                    <tal:b tal:case="True">
                                        (${layout.format_number(vote.result_people_yeas_p, 2)}% <tal:b i18n:translate>for the popular initiative</tal:b>)
                                    </tal:b>
                                </tal:b>
                            </tal:block>
                        </td>
                    </tr>
                    <tr tal:condition="vote.result_cantons_accepted">
                        <th class="column-30" i18n:translate>Cantons</th>
                        <td>
                            <span class="result-cantons-accepted">
                                ${vote.result_cantons_accepted}
                                <tal:block tal:condition="vote.result_cantons_yeas is not None and vote.result_cantons_nays is not None">
                                    <tal:b tal:switch="vote._legal_form == 5">
                                        <tal:b tal:case="False">
                                          (${layout.format_number(vote.result_cantons_yeas, 1)} <tal:block i18n:translate>Yea</tal:block>, ${layout.format_number(vote.result_cantons_nays, 1)} <tal:block i18n:translate>Nay</tal:block>)
                                        </tal:b>
                                        <tal:b tal:case="True">
                                          (${layout.format_number(vote.result_cantons_yeas, 1)} <tal:block i18n:translate>for the popular initiative</tal:block>, ${layout.format_number(vote.result_cantons_nays, 1)} <tal:block i18n:translate>for the counter-proposal</tal:block>)
                                        </tal:b>

                                    </tal:b>
                                </tal:block>
                            </span>
                            <dl tal:repeat="(result, cantons) vote.results_cantons.items()">
                                <dt>${result}</dt>
                                <dd tal:repeat="canton cantons"><tal:block tal:content="canton.html(request)" /></dd>
                            </dl>
                        </td>
                    </tr>
                    <tr tal:condition="vote.result_turnout is not None">
                        <th class="column-30" i18n:translate>Turnout</th>
                        <td>${layout.format_number(vote.result_turnout, 2)}%</td>
                    </tr>
                    <tr tal:condition="layout.attachments['resolution']">
                        <th class="column-30" i18n:translate>Resolution</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'resolution'" />
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['results_by_domain']">
                        <th class="column-30" i18n:translate>Result by canton, district and municipality</th>
                        <td>
                            <a href="${layout.attachments['results_by_domain']['url']}" target="_blank" class="results-by-domain">Excel</a>
                            <tal:block metal:use-macro="layout.macros['attachment_locale']" tal:define="name 'results_by_domain'"/>
                        </td>
                    </tr>
                    <tr tal:condition="vote.link_bk_results">
                        <th class="column-30" i18n:translate>Overview of voting result by the Federal Chancellery</th>
                        <td>
                            <a href="${vote.link_bk_results}" target="_blank" i18n:translate>Link</a>
                            <span tal:condition="request.html_lang == 'en-US'">(in German)</span>
                        </td>
                    </tr>
                    <tr tal:condition="vote.bfs_dashboard">
                        <th class="column-30" i18n:translate>Popular votes dashboard by the Swiss Federal Statistical Office</th>
                        <td>
                            <a href="${vote.bfs_dashboard}" target="_blank" i18n:translate>Link</a>
                        </td>
                    </tr>
                    <tr tal:condition="vote.bfs_map" class="bfs-map">
                        <th class="column-30" i18n:translate>Interactive map of the Swiss Federal Statistical Office</th>
                        <td>
                            <a class="button secondary" aria-role="button" href="${vote.bfs_map}" i18n:translate>Display the map</a>
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="collapsible" tal:condition="vote.link_post_vote_poll or
                                                      layout.attachments['post_vote_poll'] or
                                                      layout.attachments['post_vote_poll_methodology'] or
                                                      layout.attachments['post_vote_poll_dataset'] or
                                                      layout.attachments['post_vote_poll_dataset_sav'] or
                                                      layout.attachments['post_vote_poll_dataset_dta'] or
                                                      layout.attachments['post_vote_poll_codebook'] or
                                                      layout.attachments['post_vote_poll_codebook_xlsx'] or
                                                      layout.attachments['post_vote_poll_report'] or
                                                      layout.attachments['leewas_post_vote_poll_results']
                                                      ">
                <thead>
                    <tr><th colspan="2" i18n:translate>Post-vote polls</th></tr>
                </thead>
                <tbody>
                    <tr tal:condition="layout.attachments['post_vote_poll']">
                        <th class="column-30" tal:condition="not float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" i18n:translate>Full analysis of VOX post-vote poll results</th>
                        <th class="column-30" tal:condition="float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" i18n:translate>Full analysis of VOTO post-vote poll results</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'post_vote_poll'" />
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['post_vote_poll_report']">
                        <th class="column-30" i18n:translate>Technical report on the VOX poll</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'post_vote_poll_report'" />
                        </td>
                    </tr>
                    <tr tal:condition="vote.link_post_vote_poll">
                        <th class="column-30" tal:condition="not float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" i18n:translate>Cockpit with selected VOX results</th>
                        <th class="column-30" tal:condition="float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" i18n:translate>Cockpit with selected VOTO results</th>
                        <td><a href="${vote.link_post_vote_poll}" target="_blank" i18n:translate>Link</a></td>
                    </tr>
                    <tr tal:condition="layout.attachments['post_vote_poll_methodology']">
                        <th class="column-30" tal:condition="not float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" i18n:translate>Questionnaire of the VOX poll</th>
                        <th class="column-30" tal:condition="float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" i18n:translate>Questionnaire of the VOTO poll</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'post_vote_poll_methodology'" />
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['post_vote_poll_dataset'] or
                                       layout.attachments['post_vote_poll_dataset_sav'] or
                                       layout.attachments['post_vote_poll_dataset_dta']">
                        <th class="column-30">
                            <span i18n:translate tal:condition="not float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" >Dataset of the VOX poll</span>
                            <span i18n:translate tal:condition="float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" >Dataset of the VOTO poll</span>
                            <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="Due to data protection requirements, Swissvotes publishes a slightly reduced version of this dataset. Access to the full version might be possible for research purposes; see the Swissvotes codebook for more details on this (https://swissvotes.ch/page/dataset/codebook-en.pdf)."><i class="fa fa-info" aria-hidden="true"></i></span>
                        </th>
                        <td class="inline-links">
                            <a tal:condition="layout.attachments['post_vote_poll_dataset']" href="${layout.attachments['post_vote_poll_dataset']['url']}" target="_blank" class="post-vote-poll-dataset">CSV</a>
                            <a tal:condition="layout.attachments['post_vote_poll_dataset_sav']" href="${layout.attachments['post_vote_poll_dataset_sav']['url']}" target="_blank" class="post-vote-poll-dataset-sav">SAV</a>
                            <a tal:condition="layout.attachments['post_vote_poll_dataset_dta']" href="${layout.attachments['post_vote_poll_dataset_dta']['url']}" target="_blank" class="post-vote-poll-dataset-dta">DTA</a>
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['post_vote_poll_codebook'] or
                                       layout.attachments['post_vote_poll_codebook_xlsx']">
                        <th class="column-30" tal:condition="not float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" i18n:translate>Codebook for the VOX poll</th>
                        <th class="column-30" tal:condition="float(layout.format_bfs_number(vote.bfs_number)) in range(605, 636)" i18n:translate>Codebook for the VOTO poll</th>
                        <td class="inline-links">
                            <a tal:condition="layout.attachments['post_vote_poll_codebook']" href="${layout.attachments['post_vote_poll_codebook']['url']}" target="_blank" class="post-vote-poll-codebook">PDF</a>
                            <a tal:condition="layout.attachments['post_vote_poll_codebook_xlsx']" href="${layout.attachments['post_vote_poll_codebook_xlsx']['url']}" target="_blank" class="post-vote-poll-codebook-xlsx">Excel</a>
                            <span tal:condition="request.html_lang == 'en-US'">(in German)</span>
                        </td>
                    </tr>
                    <tr tal:condition="layout.attachments['leewas_post_vote_poll_results']">
                        <th class="column-30" i18n:translate>Results of the LeeWas post-vote poll</th>
                        <td>
                            <tal:block metal:use-macro="layout.macros['attachment_link']" tal:define="name 'leewas_post_vote_poll_results'" />
                        </td>
                    </tr>
                </tbody>
            </table>

            <div class="search">
                <h3 i18n:translate id="search">Full-text search in all documents on this vote</h3>

                <div metal:use-macro="layout.macros['form']" tal:define="form_method 'GET'"/>

                <tal:block tal:condition="vote.term">
                    <h4 i18n:translate>Search results</h4>

                    <p tal:condition="not: search_results" i18n:translate>No documents found.</p>
                    <table tal:condition="search_results">
                        <thead>
                            <th i18n:translate>Document</th>
                            <th i18n:translate>Language</th>
                        </thead>
                        <tbody>
                            <tr tal:repeat="(order, title, language, protected, file) search_results">
                                <tal:block tal:define="downloadable not protected or request.is_logged_in">
                                    <td tal:condition="not downloadable">
                                        ${title}
                                        <span i18n:attributes="title" data-tooltip aria-haspopup="true" class="has-tip" title="This document contains press articles which are protected by copyright. Therefore, we are not allowed to provide it for free download. However, you are welcome to access the document on our premises in Bern for private use. Please contact us by email at info@swissvotes.ch to make an appointment."><i class="fa fa-info" aria-hidden="true"></i></span>
                                    </td>
                                    <td tal:condition="downloadable"><a href="${request.link(file)}">${title}</a></td>
                                    <td>${language}</td>
                                </tal:block>
                            </tr>
                        </tbody>
                    </table>
                </tal:block>

            </div>
        </div>
    </tal:block>
</div>
