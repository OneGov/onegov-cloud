<div metal:use-macro="layout.base" i18n:domain="onegov.org">
    <tal:b metal:fill-slot="title">
        ${title}
    </tal:b>
    <tal:b metal:fill-slot="content">
        <div class="row">

            <div class="columns small-12 medium-8">
                <h2>
                    <tal:b i18n:translate>Results</tal:b>
                </h2>
                <tal:b tal:condition="not submission_count" i18n:translate="">No submissions yet.</tal:b>
                <b tal:condition="submission_count">Number of participants: ${submission_count}</b>

                <tal:b tal:repeat="field fields" tal:condition="submission_count">
                    <hr>
                    <h3 id="${field.id}">${field.label.text}</h3>
                    <p tal:condition="field.type not in aggregated">
                        <tal:b tal:condition="field.type == 'StringField'">
                            "${'", "'.join(results.get(field.id, []))}"
                        </tal:b>
                        <tal:b tal:condition="field.type == 'TextAreaField'">
                            <p tal:repeat="value results.get(field.id, [])">"${value}"</p>
                        </tal:b>
                    </p>
                    <tal:b tal:condition="field.type in aggregated">      
                        <div class="chart-wrap" tal:condition="field.type == 'MultiCheckboxField'">
                            <div tal:define="maximum max(results[field.id].values())" class="grid horizontal">
                                <tal:b tal:repeat="choice field.choices">
                                    <tal:b tal:define="val results[field.id][choice[0]]; max max(maximum, 1)">
                                        <div class="bar" style="--bar-value:${val/max*100}%;" data-name="${choice[1]} (${val})" title="${choice[1]} (${val})"></div>
                                    </tal:b>
                                </tal:b>
                            </div>
                        </div>
                        <div class="chart-wrap" tal:condition="field.type == 'RadioField'">
                            <div tal:define="sum sum(results[field.id].values())" class="grid horizontal">
                                <tal:b tal:repeat="choice field.choices" >
                                    <tal:b tal:define="val results[field.id][choice[0]]">
                                        <div class="bar" style="--bar-value:${val/sum*100}%;" data-name="${choice[1]} (${val}/${sum})" title="${choice[1]} (${val}/${sum})"></div>
                                    </tal:b>
                                </tal:b>
                            </div>
                        </div> 
                    </tal:b>
                </tal:b>
            </div>

            <div class="large-4 medium-4 columns">
                <div class="borderless-side-panel">
                    <h2 i18n:translate="">Fields</h2>
                    <ul>
                        <li tal:repeat="field fields">
                            <a href="#${field.id}">${field.label.text}</a>
                        </li>
                    </ul>
                </div>
            </div>

        </div>
    </tal:b>
</div>
