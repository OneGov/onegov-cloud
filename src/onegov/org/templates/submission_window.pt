<div metal:use-macro="layout.base" i18n:domain="onegov.org">
    <tal:b metal:fill-slot="title">
        ${title}
    </tal:b>
    <tal:b metal:fill-slot="content">
        <dl class="field-display">
                    <dt>
                        <h2 class="h3-size">
                            <tal:b i18n:translate>Results</tal:b>
                            <tal:b tal:condition="submission_count">(${submission_count})</tal:b>
                        </h2>
                    </dt>

                    <dd>
                        <tal:b tal:condition="not submission_count" i18n:translate="">No submissions yet.</tal:b>
                        <tal:b tal:repeat="field fields" tal:condition="submission_count">
                            <hr>
                            <h3 id="${field.id}">${field.label.text}</h3>
                            <p tal:condition="field.type not in aggregated">
                                <tal:b tal:condition="field.type == 'StringField'">
                                    "${'", "'.join(results.get(field.id, []))}"
                                </tal:b>
                                <tal:b tal:condition="field.type == 'TextAreaField'">
                                    <p tal:repeat="value results.get(field.id, [])">"${value}"</p>
                                </tal:b>
                            </p>
                            <tal:b tal:condition="field.type in aggregated">      
                                <div class="chart-wrap" tal:condition="field.type == 'MultiCheckboxField'">
                                    <div tal:define="maximum max(results[field.id].values())" class="grid horizontal">
                                        <tal:b tal:repeat="choice field.choices">
                                            <tal:b tal:define="val results[field.id][choice[0]]; max max(maximum, 1)">
                                                <div class="bar" style="--bar-value:${val/max*100}%;" data-name="${choice[1]} (${val})" title="${choice[1]} (${val})"></div>
                                            </tal:b>
                                        </tal:b>
                                    </div>
                                </div>
                                <div class="chart-wrap" tal:condition="field.type == 'RadioField'">
                                    <div tal:define="sum sum(results[field.id].values())" class="grid horizontal">
                                        <tal:b tal:repeat="choice field.choices" >
                                            <tal:b tal:define="val results[field.id][choice[0]]">
                                                <div class="bar" style="--bar-value:${val/sum*100}%;" data-name="${choice[1]} (${val}/${sum})" title="${choice[1]} (${val}/${sum})"></div>
                                            </tal:b>
                                        </tal:b>
                                    </div>
                                </div> 
                            </tal:b>
                        </tal:b>
                    </dd>
        </dl>
    </tal:b>
</div>
