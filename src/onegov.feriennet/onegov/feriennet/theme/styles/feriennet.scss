/*
    hide the news in the topbar
*/

.top-bar-section {
    ul {
        width: 100%;
    }

    li:last-child {
        display: none;
    }
}

@media #{$medium-up} {
    .is-logged-in .top-bar-section {
        li:nth-child(2),
        li:nth-child(3) {
            float: right;

            a {
                background-color: $gainsboro;
                box-shadow: 0 4px 0 $charcoal;
            }

            a:hover {
                background-color: $iron;
            }
        }
    }
}

/*
    background color of default logo
*/
svg #background {
    fill: lighten($primary-color, 25%);
}

/*
    plain panels
*/
.plain-panel {
    background: none;
    padding: 0 10px;
}

/*
    Links in simple text style (side by side)
*/
.text-links a:first-child:before {
    content: '';
}

.text-links a:before {
    color: $body-font-color;
    content: ' | ';
}

/*
    Dense lists
*/
.dense {
    list-style: none;
    margin: 0;
    padding: 0;
}

/*
    Small font
*/
.small {
    font-size: .875rem;
    line-height: 1.2rem;
}

/*
    Hints in forms
*/
form small {
    color: $form-label-font-color;
    display: block;
    font-size: .8rem;
}

/*
    Strikethrough text
*/
.strikethrough {
    text-decoration: line-through;
}

/*
    Generic icons (experimental, might replace other approaches in the future)
*/
@mixin generic-icon($icon) {
    &.before::before,
    &.after::after {
        @include icon($icon);
    }
}

.fixed-width::before,
.fixed-width::after {
    display: inline-block;
    text-align: center;
    width: 1.5ex;
}

.before::before {
    margin-right: 1ex;
}

.after::after {
    margin-left: 1ex;
}

.calendar-icon {
    @include generic-icon('\f133');
}

.child-icon {
    @include generic-icon('\f1ae');
}

.print-icon {
    @include generic-icon('\f02f');
}

/*
    editbar icons
*/

.edit-bar {
    .new-activity:before { @include icon('\f135'); }
    .request-publication:before { @include icon('\f087'); }
    .accept-activity:before { @include icon('\f087'); }
    .reject-activity:before { @include icon('\f088'); }
    .archive-activity:before { @include icon('\f187'); }
    .new-occasion:before { @include icon('\f133'); }
    .manage-periods:before { @include icon('\f02d'); }
    .new-period:before { @include icon('\f055'); }
    .run-matching:before { @include icon('\f0d0'); }
    .reset-matching:before { @include icon('\f12d'); }
    .manage-matches:before { @include icon('\f24e'); }
    .manage-billing:before { @include icon('\f155'); }
    .show-attendees:before { @include icon('\f0c0'); }
    .show-notifications:before { @include icon('\f003'); }
    .new-notification:before { @include icon('\f003'); }
}

/*
    activities list
*/
.activity-list-item {
    margin-bottom: 1.5rem;

    .page-lead {
        font-size: 1rem;
        margin-bottom: .5rem;
    }

    ul.tags {
        margin-bottom: .75rem;
    }
}

.activity-list-search {
    @include hairline;
    border-bottom-style: dashed;

    margin: 1rem 0 !important;
    padding-bottom: 1rem;

    h2 {
        font-size: $h3-font-size - $h3-font-reduction;
    }

    ul.tags {
        margin: 0;
    }
}


/*
    Activity view
*/
ul.tags {
    margin: 0 0 2rem;

    li {
        @include label(
            $text-size: .8rem,
            $radius: 15px,
            $bg: $secondary-color,
            $padding: 4px 12px
        );

        &.active {
            @include label(
                $text-size: .8rem,
                $radius: 15px,
                $bg: $primary-color,
                $padding: 4px 12px
            );
        }

        a {
            color: inherit;
        }
    }
}

.activity-status-panel {

    .field-display-label {
        font-weight: normal;
    }

    .activity-state {
        font-size: .875rem;
    }
}

.hints {
    padding: 0 0 1.25rem;
    position: relative;

    .hint {
        margin-left: 1.5rem;
        padding-bottom: .25rem;

        &:before {
            display: inline-block;
            left: 0;
            margin-top: -1px;
            position: absolute;
            text-align: center;
            width: 1rem;
        }
    }

    .hint-prebooking:before { @include icon('\f133'); }
    .hint-max-activities:before { @include icon('\f2c3'); }
    .hint-costs:before { @include icon('\f0d6'); }
    .hint-favorites:before { @include icon('\f005'); }
    .hint-matching:before { @include icon('\f12e'); }
    .hint-fairness:before { @include icon('\f24e'); }
    .hint-happiness:before { @include icon('\f118'); }
    .hint-operability:before { @include icon('\f058'); }
    .hint-outstanding:before { @include icon('\f200'); }
    .hint-finalized:before { @include icon('\f256'); }

    .hint:last-child {
        @include hairline();
    }
}

.panel .hints {
    margin: 0;
    padding: 0;

    .hint:last-child {
        border: 0;
        padding-bottom: 0;
    }
}

.hint {
    font-size: .875rem;
    line-height: 1.4rem;
}

.inactive-occasions * {
    border-bottom-color: $gainsboro !important;
    color: $charcoal;
}

/*
    Ticket view
*/
.ticket-summary {
    .page-content-main,
    .page-content-sidebar {
        @include grid-column(12);
    }
}

.FER-link::before {
    @include icon('\f135');
    display: inline-block;
    margin-right: 1ex;
}

.ticket-handler-FER td:first-child::before {
    @include icon('\f135');
}

/*
    Organiser contact
*/

.activity-organiser-panel > small {
    display: inline-block;
    font-size: .8rem;
    margin-top: .75rem;
}

.organiser {
    ul {
        list-style: none;
        margin: 0;
    }

    .organiser-name {
        font-weight: bold;
    }

    .organiser-address {
        white-space: pre-line;
        word-break: break-all;
    }

    .organiser-email {
        margin-top: .5rem;

        a::before {
            @include icon('\f0e0');
        }
    }

    .organiser-phone a::before {
        @include icon('\f095');
    }

    .organiser-website a::before {
        @include icon('\f0c1');
    }

    .organiser-phone,
    .organiser-email,
    .organiser-website {
        font-size: .875rem;
    }

    .organiser-phone a::before,
    .organiser-email a::before,
    .organiser-website a::before {
        color: $body-font-color;
        display: inline-block;
        margin-right: 1ex;
    }
}

/*
    Occasions
*/
.occasions {
    list-style: none;
    margin: 0;
    position: relative;

    h2,
    h3,
    h4 {
        font-size: 1.2rem;
        font-weight: bold;
        margin: 0 0 .5rem;
    }

    > * {
        p {
            font-size: .875rem;
            font-style: italic;
            max-width: $max-line-width;
            white-space: pre-line;
        }

        div {
            font-size: .875rem;
        }

        a {
            display: inline-block;
            font-size: .875rem;
        }
    }

    .call-to-action {
        margin-bottom: 1.5rem;
    }

    .factoids {
        margin: 0 0 .75rem;

        > div {
            margin-left: 1.5rem;

            &:before {
                display: inline-block;
                left: 1rem;
                position: absolute;
                text-align: center;
                width: 1rem;
            }
        }

        .text-links {
            margin-top: .5rem;
        }

        .available-spots,
        .full {
            font-weight: bold;
            margin-bottom: .4rem;
        }

        .full:before {
            @include icon('\f00d');
        }

        .available-spots:before {
            @include icon('\f00c');
        }

        .location:before {
            @include icon('\f041');
        }

        .age:before {
            @include icon('\f1ae');
        }

        .spots:before {
            @include icon('\f105');
        }

        .cost:before {
            @include icon('\f155');
        }

        .text-links:before {
            @include icon('\f192');
        }
    }
}

/*
    Call to Action
*/

.call-to-action {
    background-color: transparentize($primary-color, .95);
    border-radius: 2px;
    min-height: 5rem;
    padding: 1rem;

    span {
        font-size: 1rem;
    }

    .button {
        float: right;
        margin: 0;
        width: 25%;

        @media #{$medium-only} {
            width: 30%;
        }

        @media #{$small-only} {
            width: 40%;
        }
    }
}

/*
    Hide certain things from non-managers
*/
.is-not-manager {

    // file upload manager
    .redactor-toolbar .re-file {
        display: none;
    }
}

/*
    Periods view
*/
.periods {
    td {
        color: $charcoal;
        vertical-align: top;
    }

    .active {
        td {
            color: $jet;

            &:first-child {
                border-left: 10px solid $primary-color;
            }
        }
    }
}


/*
    Enrollment
*/

.enroll-form {
    h2 {
        font-size: $h2-font-size - $h2-font-reduction;
        margin: .5rem 0;
    }

    .hide-attendee .field-attendee {
        display: none;
    }
}


/*
    My bookings count
*/

// use px in this block as rem is buggy in pseud-elements in IE 11
.count[data-count]:after {
    background-color: $alert-color;
    border-radius: 100px;
    color: $white;
    content: attr(data-count);
    display: inline-block;
    font-size: 13px;
    font-weight: bold;
    height: 23px;
    line-height: 23px;
    margin: 0 0 0 7px;
    min-width: 23px;
    text-align: center;
}

/*
    My bookings
*/

.my-bookings {
    .panel {
        max-width: 77ex;
    }

    .attendee-bookings {
        .alert-box {
            margin-bottom: 0;
        }

        h3 {
            background-color: $white-smoke;
            border: 1px solid $gainsboro;
            border-radius: 2px 2px 0 0;
            border-width: 1px 1px 0;
            font-size: 1.4rem;
            font-weight: 500;
            margin: 0;

            // 8.3333% is 1000 (row-width) / 12 (number of rows)
            // -> one column wide in percentage
            padding: .75rem 1rem .75rem 8.3333%;
        }

        ul {
            list-style: none;
            margin: 0;
            padding: 0;

            li {
                margin-bottom: .5rem;
            }
        }

        > ul {
            background-color: $white;
            border: 1px solid $gainsboro;
            border-radius: 0 0 2px 2px;
            border-width: 0 1px 1px;
            box-shadow: 3px 3px 5px $white-smoke;
            margin-bottom: 1.5rem;
            padding: .5rem 0 .25rem;
        }

        .total-costs {
            background: $white-smoke;
            border: 1px solid $gainsboro;
            border-radius: 2px;
            border-width: 0 1px 1px;
            box-shadow: 3px 3px 5px $white-smoke;
            font-family: $font-family-monospace;
            margin-bottom: 1.5rem;
            margin-top: -1.5rem;
            padding: .75rem 1.2rem .75rem 8.3333%;
            position: relative;
            top: -1px;

            .columns:last-child {
                text-align: right;
            }
        }

        .total {
            font-weight: bold;
        }

        .cost {
            font-family: $font-family-monospace;
            font-size: .875rem;
            position: absolute;
            right: 1rem;
            top: .5rem;
        }

        .fa-star-o,
        .fa-star {
            font-size: 1.5rem;
            padding: 2px 0;
        }

        .fa-star-o {
            color: $base;
        }

        .fa-star {
            color: $yellow;
        }
    }

    h4 {
        font-size: 1.2rem;
        font-weight: 500;
        margin-bottom: .25rem;
        max-width: 80%;
    }

    .occasion {
        font-size: .875rem;
        margin-bottom: .1rem;
    }

    .operability-warning {
        font-size: .8rem;
        padding-top: .15rem;

        &:before {
            @include icon('\f06a');
            color: $orange-dark;
            margin: 0 1ex;
        }
    }

    .state {
        background-color: $aluminum;
        border-radius: 5px;
        color: $white;
        display: inline-block;
        font-size: .8rem;
        margin-bottom: .5rem;
        padding: 0 6px;

        &.cancelled {
            background-color: $red;
        }

        &.denied {
            background-color: $alert-color;
        }

        &.accepted {
            background-color: $success-color;
        }
    }

    .non-operable .state.accepted {
        background-color: $orange;
    }

    .actions {
        ul {
            margin: 0;

            li {
                font-size: .875rem;
                margin: 0;

                &:after {
                    color: $body-font-color;
                    content: ' | ';
                }

                &:first-child:after {
                    content: '';
                }
            }
        }
    }
}


/*
    Form panel on the right
*/
.form-panel {
    form {
        #confirm {
            margin-bottom: .5rem;
        }

        legend {
            background: transparent;
            margin: 0 0 .5rem;
            padding: 0;
            text-align: left;
        }

        input[type="submit"] {
            margin-bottom: 0;
        }

        fieldset {
            border: 0;
            margin: .5rem 0 .75rem;
        }

        .field-confirm .label-text {
            display: inline-block;
            font-weight: bold;
            margin-bottom: .5rem;
        }

        .field-sure label {
            margin: 0 0 .5rem;
        }

        + a {
            padding-top: 1rem;
        }
    }

    a {
        font-size: .875rem;
    }

    p {
        font-size: .875rem;
        margin: 0;
    }
}

/*
    Matching view
*/

.matched-occasion {
    margin-bottom: 1rem;

    h4 {
        margin-top: 1rem;
    }

    table {
        width: 100%;

        td:first-child,
        th:first-child {
            width: 50%;
        }

        td {
            position: relative;

            span,
            div {
                display: inline-block;
                left: 10px;
                overflow: hidden;
                position: absolute;
                right: 10px;
                text-overflow: ellipsis;
                white-space: nowrap;
            }
        }

        td:before {
            content: '&nbsp;';
            visibility: hidden;
        }
    }

    .subtitle {
        display: block;
        margin: 0 0 1rem;
    }

    .booking-accepted {
        background-color: $green-pastel !important;

        + .booking-other td {
            box-shadow: 0 -2px 0 $green;
        }
    }

    .matching-details {
        display: inline-block;
        width: 75%;

        button {
            float: right;
            font-size: 1.2rem;
            height: 2.5rem;
            line-height: 1.2rem;
            margin-bottom: 0;
            padding: 0;
            width: 2.5rem;

            &.alert {
                background-color: $red-light;

                &:hover,
                &.toggled {
                    background-color: $red;
                }
            }

            &.success {
                background-color: $green-light;

                &:hover,
                &.toggled {
                    background-color: $green;
                }
            }
        }
    }

    .progress {
        border: 0;
        cursor: pointer;
        display: inline-block;
        height: 2.5rem;
        padding: 0;
        position: relative;
        width: calc(100% - 2.5rem);

        .meter {
            width: 100%;
        }

        &.success .meter {
            background-color: $green-pastel;
        }

        &.alert .meter {
            background-color: $red-pastel;
        }

        &.success .meter-text::before {
            @include icon('\f058');
            color: $green;
            margin-right: 1ex;
        }

        &.alert .meter-text::before {
            @include icon('\f06a');
            color: $red;
            margin-right: 1ex;
        }
    }

    .meter-text {
        font-size: .9rem;
        left: 0;
        line-height: .9rem;
        padding: .75rem;
        position: absolute;
        top: 0;
    }
}

/*
    Billing View
*/
.bill {
    border-radius: 2px;
    margin-bottom: 1rem;
    padding: 0;
    position: relative;

    h3 {
        color: $red-dark;
        display: inline-block;
        font-size: 1rem;
        font-weight: bold;
        line-height: 1.5rem;
        margin: .5rem .25rem .5rem .75rem;
    }

    button {
        float: right;
        height: 40px;
        margin: 0;
        padding: .25rem;
        position: absolute;
        right: 0;
        top: 0;
        width: 40px;
    }

    .circle.button {
        background-color: $yellow-pastel;
        border: 1px solid $yellow;
        border-radius: 100px;
        color: $body-font-color;
        float: right;
        font-size: 12px;
        height: 24px;
        line-height: 12px;
        margin: 0;
        padding: 5px;
        width: 24px;

        &:hover {
            background-color: $yellow;
        }

        + .f-dropdown li a {
            font-size: .8rem;
            font-weight: normal;
        }
    }

    .f-dropdown {
        max-width: 250px;
    }

    table {
        margin: 1px 0 0;
        position: relative;
        width: 100%;

        tr {
            background-color: transparent;

            &.paid:hover {
                background-color: $green-pastel !important;
            }

            &.unpaid:hover {
                background-color: $red-pastel !important;
            }
        }

        td {
            border: 0;
            padding-bottom: .25rem;
            padding-top: .25rem;
        }

        .group td {
            padding-bottom: .75rem;
            padding-top: .75rem;
        }

        .payment-status,
        .amount,
        .actions {
            padding-left: 0;
            padding-right: 0;
            width: 1%;
        }

        .total .amount {
            padding-top: .75rem;
        }

        .actions,
        .amount {
            padding-right: .5rem;
        }

        .payment-status {
            padding-right: 1.5rem;
        }

        .total td {
            padding-bottom: .5rem;
            padding-top: .5rem;
        }

        .total td:last-child {
            padding-right: .75rem;
        }

        .amount {
            font-family: $font-family-monospace;
            padding-top: .5rem;
            text-align: right;
        }

        .total td,
        .group td:first-child {
            font-weight: bold;
            text-decoration: underline;
            text-decoration-color: $body-font-color;
        }

        tbody tr:nth-last-child(2) td {
            // make sure the backgrounds of all item lines cover the same
            // height, here we mask the extended height of the row with
            // a white box-shadow
            box-shadow: 0 -.75rem $white inset;
            padding-bottom: 1rem;
        }

        .unpaid {
            .payment-status {
                color: $red-dark;
                text-align: left;
            }

            .amount {
                color: $red-dark;
            }
        }

        .paid {
            .payment-status {
                color: $green-dark;
                text-align: left;
            }

            .amount {
                color: $green-dark;
            }
        }
    }

    .mark-paid:before {
        @include icon('\f058');
        margin-right: 1ex;
    }

    .mark-unpaid:before {
        @include icon('\f071');
        margin-right: 1ex;
    }

    &.paid {
        background-color: $green-pastel;
        border: 1px solid $green-pastel;

        > * {
            color: $green-dark;
        }

        button {
            background-color: $green-light;
            color: $white;
            outline: 1px solid $green-light;
        }

        button.toggled,
        button:hover {
            background-color: $green-dark;
            outline: 1px solid $green-dark;
        }

        .total td {
            background-color: $green-pastel;
            color: $green-dark;
            font-size: 1rem;
            text-decoration: none;
        }
    }

    &.unpaid {
        background-color: $red-pastel;
        border: 1px solid $red-pastel;

        > * {
            color: $red-dark;
        }

        button {
            background-color: $red-light;
            color: $white;
            outline: 1px solid $red-light;
        }

        button.toggled,
        button:hover {
            background-color: $red-dark;
            outline: 1px solid $red-dark;
        }

        .total td {
            background-color: $red-pastel;
            color: $red-dark;
            font-size: 1rem;
            text-decoration: none;
        }
    }

    > .outstanding {
        float: right;
        line-height: 1.5rem;
        margin: .5rem calc(48px + .5rem) .5rem 0;

        .button {
            margin-left: 1rem;
        }
    }
}

/*
    Invoices View
*/

.paid .invoice-items-list {
    border-bottom: 1px solid $green-pastel;
}

.unpaid .invoice-items-list {
    border-bottom: 1px solid $red-pastel;
}

.invoice-items-list {
    background: $white;
    padding: 1rem 3.5rem 1rem 1.5rem;
    position: relative;
    top: 1px;

    ul {
        color: $body-font-color;
        list-style: none;
        margin: 0;
    }

    .item-group,
    .item-total {
        margin-top: 1rem;
    }

    .item-group:first-child {
        margin-top: 0;
    }

    .item-amount {
        display: relative;
        float: right;
        font-family: $font-family-monospace;
    }

    li.paid .item-amount:after {
        @include icon('\f05d');
        color: $green-dark;
        font-weight: normal;
        margin-top: -2px;
        position: absolute;
        right: 33px;
    }

    li.unpaid .item-amount:after {
        @include icon('\f06a');
        color: $red-dark;
        font-weight: normal;
        margin-top: -2px;
        position: absolute;
        right: 33px;
    }
}

/*
    Occassion-Attendee View
*/

.print {
    display: block;
    font-size: .9em;
    margin-bottom: .5rem;
    margin-top: -.5rem;
}

.print-all {
    display: block;
    font-size: 1.1rem;
    margin-bottom: .75rem;
    margin-top: -.75rem;
}

.occasion-attendance {

    margin-bottom: 1.5rem;

    .attendance-header {
        padding-bottom: .5rem;
        page-break-after: avoid;
        page-break-inside: avoid;

        h2 {
            font-size: $h3-font-size - $h3-font-reduction;
        }

        div {
            font-size: .9em;  // em for correct scaling in print
        }
    }

    .attendees {
        font-size: .9em;  // em for correct scaling in print

        li {
            margin-bottom: .5rem;
            page-break-inside: avoid;
        }
    }
}

@media print {
    .print {
        display: none !important;
    }

    h2 {
        border-bottom: 0;
    }
}

/*
    Emergency contact
*/

.emergency-contact {
    @include panel;
    margin-bottom: 1.5rem;
    max-width: rem-calc(1000) / 12 * 8 - rem-calc(30);

    div {
        margin-bottom: .5rem;
        max-width: $max-line-width;
    }
}

.emergency-contact-missing {
    div:first-child {
        font-weight: bold;
    }
}

/*
    Notifications view
*/
.notifications li {
    margin-bottom: .5rem;

    &:before {
        @include icon('\f003');
        display: inline-block;
        font-size: 1.1rem;
        margin-right: .5rem;
        width: 1rem;
    }

    h2 {
        display: inline-block;
        font-size: 1.1rem;
        margin-bottom: 0;
    }

    div {
        font-size: .9rem;
        margin-left: 1.75rem;
    }
}

/*
    Notifications form
*/
.variables-panel {
    h2 {
        font-size: $h3-font-size - $h3-font-reduction;
    }

    h3 {
        display: inline-block;
        font-family: $font-family-monospace;
        font-size: .875rem;
        font-weight: bold;
        margin-bottom: .25rem;
    }

    li + li {
        margin-top: .75rem;
    }

    span {
        display: block;
        font-size: .875rem;
    }
}

/*
    Notification Mailing
*/

.notification-preview {
    background: $white-smoke;
    margin-bottom: 1rem;
    max-width: $max-line-width + 7rem;
    padding: .75rem 1rem;
    position: relative;

    h3 {
        border-bottom: 1px solid $jet;
        font-size: 1rem;
        font-weight: bold;
        margin-bottom: 1rem;
    }

    p {
        margin-bottom: .75rem;
        max-width: $max-line-width;
    }

    p:last-child {
        margin-bottom: 0;
    }

    a.control {
        bottom: 1rem;
        display: inline-block;
        font-weight: bold;
        position: absolute;
        right: 1rem;
    }
}
