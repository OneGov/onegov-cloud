<div metal:use-macro="layout.base" i18n:domain="onegov.feriennet">
    <tal:block metal:fill-slot="title">
        ${title}
    </tal:block>
    <tal:block metal:fill-slot="content">
        <tal:block repeat="oid occasions">
            <div tal:define="records occasions[oid]" class="matched-occasion matched-state-${records['state']}">
                <h3>${records['first'].activity_title}</h3>
                <span class="subtitle">${layout.format_datetime_range(
                    layout.to_timezone(
                        records['first'].occasion_start,
                        records['first'].occasion_timezone
                    ),
                    layout.to_timezone(
                        records['first'].occasion_end,
                        records['first'].occasion_timezone
                    ),
                )}, ${records['first'].occasion_spots.lower} -
                    ${records['first'].occasion_spots.upper - 1}
                    <i class="fa fa-child" aria-hidden="true"></i>
                </span>

                <h4 class="show-for-sr" i18n:translate>Bookings</h4>
                <tal:block condition="not:records['accepted'] or records['other']" i18n:translate>
                    No bookings.
                </tal:block>

                <table class="matches" tal:condition="records['accepted'] or records['other']">
                    <thead>
                        <tr>
                            <th i18n:translate>Name</th>
                            <th i18n:translate>Age</th>
                            <th i18n:translate>State</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tal:block repeat="kind ('accepted', 'other')">
                            <tr tal:repeat="record records[kind]" class="booking booking-${kind} ${record.booking_state}">
                                <td>${record.attendee_name}</td>
                                <td>${int(record.attendee_age)}</td>
                                <td>
                                    <tal:block
                                        define="state record.booking_state"
                                        metal:use-macro="layout.macros.confirmed_booking_state"
                                    />
                                </td>
                            </tr>
                        </tal:block>
                    </tbody>
                </table>
            </div>
        </tal:block>
    </tal:block>
</div>
